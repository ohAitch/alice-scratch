#!/usr/bin/env node
// hey, if you're gonna break this, keep a previous stable version ready this time. ive spent entirely too much time rescuing our state

// odd synonym: k, name(, id)(, i?), êëØêë±êë•
// Œπ = it
// ‚Äñ = size/length/shape

//################################### prelude ###################################
'use strict' ;require('module').wrapper[0] += `'use strict';` // enable strict mode everywhere

//################################### Œ∂ infra ###################################
var Œ≥ = global
Œ≥.Œ≥ = Œ≥
var def0 = Object.defineProperty
Œ≥.def = (o,name,Œπ)=> def0(o,name,_u({configurable:true,enumerable:true}).assign(Œπ))
Œ≥.êÖØSet = (...Œπ)=> new Set(Œπ)

//################################### prelude ###################################
Œ≥._u = require('/usr/local/lib/êÖ™êÖ©modu/underscore@1.8.3__57/node_modules/underscore') // lodash is better than underscore except for _()

Œ≥._interrobang_ = (...a)=>{ throw a["‚Äñ"]===1 && T.Error(a[0])? a[0] : Error(a.map(Œπ=> Tstr(Œπ)? Œπ : Œ∂_inspect(Œπ)).join(' ')) }
Œ≥.catch_union = f=>{ try{ var r = f() ;var bad = T.Error(r) ;if( !bad) return r }catch(e){ var r = e ;T.Error(r) || _interrobang_() ;return r } ;bad && _interrobang_() }
Œ≥.catch_union2 = f=>{ try{return f() }catch(e){return e } }
Œ≥.catch_Œπ = f=>{ try{ var r = f() ;var bad = r===undefined ;if( !bad) return r }catch(e){} ;bad && _interrobang_() }
Œ≥.catch_ = f=> function(){ try{ return f.apply(this,arguments) }catch(e){ '__catchable' in e || _interrobang_(e) ;return e.__catchable } }
Œ≥.return_ = Œπ=>{ throw {__catchable:Œπ} }
Œ≥.new_ = Œπ=> Object.create( Œπ? Œπ.prototype || Œπ : null )

Œ≥.T = Œπ=>{var t;
	if( (t= typeof Œπ)!=='object' ) return t==='boolean'? '‚úì‚úó' : t ;if( Œπ===null ) return 'null'
	if( Object.getPrototypeOf(Œπ)===Object.prototype ) return 'object'
	for( t of is_l ) if( t[1](Œπ) ) return t[0]
	return 'object' }
var b_util = catch_Œπ(()=> process.binding('util') )
var is_l = [
	['Array',Array.isArray]
	,['Buffer',Buffer.isBuffer]
	// , ['Error',Œπ=> Object.prototype.toString.call(Œπ)==='[object Error]' || Œπ instanceof Error]
	,... ['Error','String','Boolean','Number'].map(ty=> [ty,Œπ=> Object.prototype.toString.call(Œπ)==='[object '+ty+']'])
	,... !b_util? [] : ['AnyArrayBuffer','DataView','Date','Map','MapIterator','Promise','RegExp','Set','SetIterator','TypedArray'].map(Œπ=> [Œπ,eval(`Œπ=> b_util.is${Œπ}(Œπ)`)])
	]
// would like to be using ‚àà instead
Object.assign(T,_u(is_l).object(),{
	symbol: Œπ=> typeof Œπ==='symbol'
	,truefalse: Œπ=> typeof Œπ==='boolean'
	,string: Œπ=> typeof Œπ==='string'
	,number: Œπ=> typeof Œπ==='number'
	,function: Œπ=> typeof Œπ==='function'
	,primitive: Œπ=>{ switch(typeof Œπ){ case'undefined': case'boolean': case'number': case'string': case'symbol': return true ;case'object': return Œπ===null ;default: return false } }
	,boxed: Œπ=>{ if( Œπ===null || typeof Œπ!=='object' ) return false ;var t = Object.getPrototypeOf(Œπ) ;t = t.constructor&&t.constructor.name ;return ( t==='Boolean'||t==='String'||t==='Number' ) && /^\[object (Boolean|String|Number)\]$/.test(Object.prototype.toString.call(Œπ)) }
	,‚Ñ§: Number.isInteger
	,'-0': Œπ=> Œπ===0 && 1/Œπ < 0
	,NaN: Number.isNaN
	})
Object.assign(Œ≥,{ Tstr:T.string ,Tnum:T.number ,Tfun:T.function ,Tarr:T.Array ,Tprim:T.primitive })
T.primitive.Œπ = êÖØSet('undefined','boolean','number','string','symbol','null')
T.boxed.Œπ = êÖØSet('Boolean','String','Number')

Œ≥.falsy = Œπ=> Œπ===undefined||Œπ===null||Œπ===false
Œ≥.orundefined = (a,b)=> a!==undefined? a : b

//################################### Œ∂ infra ###################################
// prefix hook . does not require parens around the right side, but can only do side effects
Œ≥.êÖØêÖÆêÖ¶êÖ¨êÖÇ = f=>{ êÖ≠êÖ©êÖùêÖãêÖ©.f = f ;return êÖ≠êÖ©êÖùêÖãêÖ© } ;var êÖ≠êÖ©êÖùêÖãêÖ© = def({ f:undefined },'Œπ',{ set(Œπ){ this.f(Œπ) } })

//############### postfix ###############
// def(Function.prototype,'‚Äò@',{ ,get(){‚Ü© @.call.bind(@) } })
// def(Function.prototype,'flip_',{ ,get(){‚Ü© (a,b)=> @(b,a) } })
var Iterator = Œπ=>0?0: { [Symbol.iterator]: (i=>( i.Œπ = Œπ ,i ))( Œπ[Symbol.iterator].bind(Œπ) ) }
var êÖûêÖû = Iterator([])
Œ≥.postfix = new Proxy(êÖûêÖû,{set(À£,id,Œπ,self){var t; id+='' ;êÖûêÖû[Symbol.iterator].Œπ.push(id)
	;(Œ≥[id] = Œπ)[Symbol.toPrimitive] = (Œπ=>()=>Œπ)(Symbol(id))
	var wrap = f=>0?0: { enumerable:false ,get:(Œπ=>()=>Œπ)( function(){return f.call(undefined,this,...arguments) } ) ,set(f){ def(this,Œπ,wrap(f)) } }
	def(Object.prototype,Œπ,wrap(Œπ))
	return true }})

postfix['|>'] = (Œπ,f)=> f(Œπ)
postfix['<|'] = (f,Œπ)=> f(Œπ)
postfix['!>'] = (Œπ,f)=>( f(Œπ) ,Œπ )
postfix['‚Ä¶‚Üê'] = Object.assign
postfix['‚Ä¶‚Üê|'] = (a,...b)=>{ for(var Œπ of b) for(var i of Object.getOwnPropertyNames(Œπ)) a.hasOwnProperty(i) ||( a[i] = Œπ[i] ) ;return a }
postfix['‚àã'] = (a,b)=> Object.prototype.isPrototypeOf.call( a.prototype||a ,b )

var êÖ®êÖùêÖÉêÖÇêÖÆ = ()=> function me(...a){ var l = me['‚â´'] ;var t = l[0].call(this,...a) ;for(var i=1;i<l["‚Äñ"];i++) t = l[i](t) ;return t }
// should be on Function.prototype instead of Object.prototype
postfix['‚â´'] = (...Œπ)=>{ Œπ=Œπ['map‚Ä¶'](Œπ=> Œπ['‚â´'] || [Œπ] ) ;return Œπ["‚Äñ"]<=1? Œπ : êÖ®êÖùêÖÉêÖÇêÖÆ() [Œ≥['‚Ä¶‚Üê']]({'‚â´':Œπ}) }
postfix['‚â™'] = (...Œπ)=> Œ≥['‚â´'](...Œπ.reverse())

// obj_hash ‚Üê Œπ=> [ ,[(a,b)=>a===b,[‚Ä¶protos(Œπ)][1]] ,[‚âà,ps(Œπ)] ,‚Ä¶(Tfun(Œπ)? [[(a,b)=>a===b,Function.prototype.toString.call(Œπ)]] : []) ]
// postfix['#obj='] = (a,b)=> [a,b].map(obj_hash) |> (Œπ=> _u.zip(‚Ä¶Œπ)).every(([a,b])=> a[0](a[1],b[1]))

//############## Property ###############
// minimal
Œ≥.Property = function(o,_id){ ;this.o = o ;this._id = _id }
def(Property.prototype,'Œπ',{ get(){return this.o[this._id] } ,set(Œπ){ this.o[this._id] = Œπ } })
def(Property.prototype,'‚àÉ',{ get(){return Object.prototype.hasOwnProperty.call(this.o,this._id) } ,set(Œπ){ !Œπ? delete this.o[this._id] : this["‚àÉ"] || def(this.o,this._id,{ value:undefined ,writable:true ,enumerable:orundefined(Œπ.enumerable,true) }) } })
def(Property.prototype,'host',{ get(){return Object.getOwnPropertyDescriptor(this.o,this._id) } ,set(Œπ){ def0(this.o,this._id,Œπ) } }) // not a real setter. funky!
def(Property.prototype,'enumerable',{ get(){return this.host.enumerable } ,set(Œπ){ this["‚àÉ"] = true ;this.host = {enumerable:Œπ} } })
def(Property.prototype,'üîí',{ get(){return !this.host.configurable } ,set(Œπ){ this["‚àÉ"] = true ;this.host = {configurable:!Œπ} } })
def(Property.prototype,'value',{ get(){return this.host.value } ,set(Œπ){ this["‚àÉ"] = true ;this.host = {value:Œπ} } })
def(Property.prototype,'slot',{set(Œπ){ this["‚àÉ"] = {enumerable:false} ;this.host = Tfun(Œπ)? Œπ["‚Äñ"]===0? {get:Œπ} : {set:Œπ} : _interrobang_() }})
def(Property.prototype,'get',{
	set(Œπ){ this["‚àÉ"] = true ;this.host = {get:Œπ} }
	// ,get(){ h ‚Üê @.host ;‚Ü© h && 'get' in h? h.get : => @.host.value }
	})
def(Property.prototype,'set',{
	set(Œπ){ this["‚àÉ"] = true ;this.host = {set:Œπ} }
	// ,get(){ h ‚Üê @.host ;‚Ü© h && 'get' in h? h.set : (Œπ=> @.host = {value:Œπ}) }
	})
Œ≥.êÖØêÖ≠êÖùêÖ®êÖÆ = new Proxy({},{get(À£,id){return new Property(êÖãêÖ®êÖ¶êÖ®êÖ≠,id) }}) ;Œ≥.êÖãêÖ®êÖ¶êÖ®êÖ≠ = undefined

Property.prototype["map!"] = function(f){ this.Œπ = f(this.Œπ,this._id,this.o) ;return this }
Property.prototype.Œî = function(f){
	var Œπ; this [Œ≥['‚Ä¶‚Üê']] ({ get(){return Œπ } ,set(_Œπ){ f(_Œπ) ;Œπ = _Œπ } ,"üîí":true })
	return this }
Property.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"f")) .get=function(){return this.Œπ.bind(this.o) }
Property.prototype.bind = function(Œπ){ Œπ instanceof Property || _interrobang_()
	this .host= { get(){return Œπ.get.call(this) } ,set(Œπ){return Œπ.set.call(this,Œπ) } ,enumerable:Œπ.enumerable }
	return this }
var thunk_s = ff=> function(Œπ){ var _id = this._id
	var get = Tfun(Œπ)? ff(Œπ,_id) : T.Promise(Œπ)? ()=> Œπ.Œπ : _interrobang_()
	this .host= { configurable:true ,get ,set(Œπ){ this[Œ≥["|>"]] (o=>( êÖãêÖ®êÖ¶êÖ®êÖ≠ = o ,êÖØêÖ≠êÖùêÖ®êÖÆ ))[_id] .host= { value:Œπ ,writable:true } } } }
Property.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"thunk")) .set= thunk_s((Œπ,_id)=> function(){return this[_id] = Œπ.call(this) })
Property.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"f1Œπ")) .set= thunk_s((Œπ,_id)=> function(){ var r= Œπ.call(this) ;r!==undefined &&( this[_id] = r ) ;return r })

//################################## module.Œ∂ ###################################
Œ≥.node = {} ;var êÖ©êÖã = (a,b)=> node[Œ≥["|>"]] (o=>( êÖãêÖ®êÖ¶êÖ®êÖ≠ = o ,êÖØêÖ≠êÖùêÖ®êÖÆ ))[a] .thunk=()=> require(b) ;require('/usr/local/lib/êÖ™êÖ©modu/builtin-modules@2.0.0__57/node_modules/builtin-modules').map(Œπ=>êÖ©êÖã(Œπ,Œπ)) ;êÖ©êÖã('EventEmitter','events') ;êÖ©êÖã('Module','module')
Œ≥._l = require('/usr/local/lib/êÖ™êÖ©modu/lodash@4.17.4__57/node_modules/lodash')
Œ≥._ = _u
Œ≥.require_new = Œπ=> (êÖÉêÖúêÖûêÖ∞êÖØ||(êÖÉêÖúêÖûêÖ∞êÖØ= require('/usr/local/lib/êÖ™êÖ©modu/require-uncached@1.0.3__57/node_modules/require-uncached') ))( (Œπ+'').replace(/^\.(?=\/)/,œÜ.cwd) ) ;var êÖÉêÖúêÖûêÖ∞êÖØ;

Œ≥.npm = (...a)=>{ var Œπ=a[0]+'' ;return Œπ.includes('@')? require(npm_init(...a)) : 'npm`'+Œπ+'@'+sh·µ•`npm show ${Œπ} version`+'`' }
var npm_init = (id_ver,sub='')=>{ id_ver+=''
	var êÖ´ = œÜ`/usr/local/lib/êÖ™êÖ©modu/${id_ver+'__'+process.versions.modules}/node_modules`
	// to match ABI, https://github.com/electron/electron/blob/master/docs/tutorial/using-native-node-modules.md
	if(! êÖ´["‚àÉ"] ) sh·µ•`cd ${êÖ´.dir_ensure.œÜ`..`} && npm --cache-min=Infinity install ${id_ver}`
	return êÖ´.œÜ`${id_ver.split('@')[0]}`+sub }
// in theory, log whenever somebody uses an outdated lib

//################################### prelude ###################################
Œ≥.memoize_proc = f=>{ var cache = new Map() ;return ((...Œπ)=> cache['has‚Ä¶'](...Œπ)? cache['get‚Ä¶'](...Œπ) : cache['set‚Ä¶'](...Œπ,f(...Œπ)) ) [Œ≥['‚Ä¶‚Üê']] ({cache}) }
Œ≥.memoize_weak = f=>{ var cache = new WeakMap() ;return (Œπ=>{ if( cache.has(Œπ) ) return cache.get(Œπ) ;Tprim(Œπ) && _interrobang_() ;var r = f(Œπ) ;cache.set(Œπ,r) ;return r }) [Œ≥['‚Ä¶‚Üê']] ({cache}) }
// resource management is a thing & i havent thought about it enough
// WeakMap doesn't fix memoization resource management when keys are Tprim or equality isn't ===
// this does
Œ≥.memoize_tick = f=>{ f = memoize_proc(f) ;var cache = f.cache ;return (Œπ=>{ var t = Œπ+'' ;process.nextTick(()=> cache.delete(t) ) ;return f(Œπ) }) [Œ≥['‚Ä¶‚Üê']] ({cache}) }
// ? frp will remove the last use(s) of @device0
Œ≥.device0_n1_dir = '/~/Library/Caches/Œ∂.persist.0'
Œ≥.thisdevice0 = Œπ=> œÜ(device0_n1_dir).œÜ`${Œπ+''}`[Œ≥["|>"]] (Œπ=> new Property(Œπ,"json"))
Œ≥.thisdevice0buf = Œπ=> œÜ(device0_n1_dir).œÜ`${Œπ+''}`[Œ≥["|>"]] (Œπ=> new Property(Œπ,"buf"))
Œ≥.thisproc = Œπ=> êÖúêÖ©êÖ≠êÖ¶êÖ∞[Œ≥["|>"]] (o=>( êÖãêÖ®êÖ¶êÖ®êÖ≠ = o ,êÖØêÖ≠êÖùêÖ®êÖÆ ))[Œπ+''] ;var êÖúêÖ©êÖ≠êÖ¶êÖ∞ = {}

//################################### Œ∂ infra ###################################
Œ≥[Œ≥["|>"]] (Œπ=> new Property(Œπ,"_section_sign__")) .thunk=()=> (Œπ=>Œπ+'') [Œ≥["‚â´"]](memoize_proc(Œπ=> require_new('/~/code/scratch/fast-parse/lang.Œ∂').parse(Œπ)))
Œ≥[Œ≥["|>"]] (Œπ=> new Property(Œπ,"_section_sign_0")) .thunk=()=> (Œπ=>Œπ+'') [Œ≥["‚â´"]](thisdevice_memo(Œπ=> require('/~/code/scratch/fast-parse/lang0.Œ∂').parse(Œπ)))
Œ≥._section_sign_1 = Œπ=>{
	Œπ.length===1||_interrobang_() ;Œπ = Œπ[0]
	Œπ.tag===':' && falsy(Œπ.Œπ[1]) || _interrobang_() ;Œπ = Œπ.Œπ[0]
	return {set _(b){
		var êÖ®êÖ™êÖãêÖ™ = Œπ=> Œπ.tag==='.'? [...êÖ®êÖ™êÖãêÖ™(Œπ.Œπ[0]),Œπ.Œπ[1]] : [Œπ] ;Œπ = êÖ®êÖ™êÖãêÖ™(Œπ)
		Œπ.every(Œπ=> Tstr(Œπ) || Œπ.tag==='string' || ( Œπ.tag==='{}' && falsy(Œπ.Œπ[0]) && Œπ.Œπ.slice(1).every(Œπ=> Tstr(Œπ) || Œπ.tag==='string' ) ) ) || _interrobang_() ;Œπ = cartesian(... Œπ.map(Œπ=> Tstr(Œπ)? [Œπ] : Œπ.tag==='string'? [Œπ.Œπ] : Œπ.Œπ.slice(1)) ) // bullshit
		b = b.get||b.set||'value' in b? b : { configurable:true ,enumerable:true ,writable:true ,value:b }
		Œπ.forEach(Œπ=> Œπ.slice(0,-1).reduce((r,Œπ)=>r[Œπ],Œ≥) [Œ≥["|>"]] (o=>( êÖãêÖ®êÖ¶êÖ®êÖ≠ = o ,êÖØêÖ≠êÖùêÖ®êÖÆ ))[Œπ[Œπ.length-1]] .host= b )
		}}
	}
Œ≥._section_sign_ = Œπ=> _section_sign_1(_section_sign_0(Œπ))

Œ≥.__name = name=>(êÖ≠êÖû)=>êÖ≠êÖû[Œ≥["|>"]] (Œπ=> new Property(Œπ,"name")) [Œ≥["!>"]]((êÖ≠êÖû)=>êÖ≠êÖû.enumerable= false) .value= name
Œ≥.seq_ws = Œπ=> (Œπ+'').split(/\s+/)
Œ≥.alt_s = Œπ=> êÖØSet(... _u(Œπ).sortBy(Œπ=> -Œπ["‚Äñ"]) )
Œ≥.alt_ws = Œπ=> alt_s(seq_ws(Œπ))
Œ≥.lines = Œπ=>{ var t = ( Œπ.raw? Œπ.raw[0] : Œπ ).split('\n') ;return t.slice( t[0].trim()?0:1 ,t["‚Äñ"] - (t[-1].trim()?0:1) ) }
Œ≥[Œ≥["|>"]] (Œπ=> new Property(Œπ,"Œ∂_compile")) .thunk=()=>{ var êÖ≠êÖãêÖ¶êÖùêÖú;var êÖ®êÖãêÖ¶êÖúêÖ¶;var êÖ©êÖúêÖÉêÖ©êÖ™;var êÖÇêÖÇêÖÉêÖùêÖ¶;var êÖ®êÖÇêÖ´êÖØêÖÉ;var êÖãêÖùêÖûêÖ¨êÖ∞;var êÖùêÖ©êÖ≠êÖ™êÖÉ;var êÖÆêÖ∞êÖ∞êÖùêÖ≠;var êÖ≠êÖ¶êÖ´êÖ©êÖù;var êÖ¶êÖûêÖÉêÖùêÖ™;var êÖÉêÖ™êÖúêÖ´êÖÆ;var êÖ™êÖØêÖØêÖØêÖ¶;
	var word_extra = re`(?:[‚ôà-‚ôìüîÖüîÜüéµüé≤‚Ä°‚ß´‚óä¬ß‚ñ£‚ãØ‚ÄΩ‚Äò‚âà‚ââ‚ßó]|êÖÉop<|êÖÉêÖ≠op<)`
	var word = re`(?:[A-Za-z0-9_$ ∞- ∏À°-À£Œë-Œ°Œ£-œâ·¥¨-·µõ·µ¢-·µ•·∂ú·∂†·∂ª‚Å∞‚Å±‚Åø‚Çê-‚Çì‚Çï-‚Çú‚ÑÇ‚Ñï‚Ñö‚Ñù‚Ñ§‚±º‚±Ω‚öìêÖÇêÖÉêÖãêÖúêÖùêÖûêÖ¶êÖ®êÖ©êÖ™êÖ´êÖ¨êÖ≠êÖÆêÖØêÖ∞êëê-êëø‚àû·õü]|${word_extra})`
	var Œ∂_parse = Œ≥.Œ∂_parse = (()=>{
		var P = require('./parsimmon2.js')
		var ident = P(re`(?![0-9])${word}+|@`)
		var comment = re`(//.*|/\*[^]*?(\*/|$)|#[\s#].*)+`
		var simple_js = P(()=> P.alt(
			P(comment).T`comment`
			,P.seq( P('{') ,simple_js ,P('}') )
			,P.seq( P.alt(
				P(/(['"])(((?!\1)[^\\]|\\.)*?\1)/).T`string`
				,ident
				,P.seq( P('`').T`template` ,tmpl_Œπ.many() ,P('`').T`template` )
				,P(/[)\]0-9]/)
				) ,P.alt( P(re`[ \t]*(?!${comment})/`) ,P.of('') ) )
			,P(/\[#persist_here .*?\]/)
			,P(re`/((?:[^/\\\[]|(?:\\.)|\[(?:[^\\\]]|(?:\\.))*\])*)/([a-z]*)`).T`regex`
			,P(re`(?:(?!${word})[^{}/#'"‚Ä¶${'`'})@\[\]])+|[^}]`)
			).many() )
		var tmpl_Œπ = P.alt( P.seq( P('${').T`template` ,simple_js ,P('}').T`template` ) ,P(/(?:\\[^]|(?!`|\$\{)[^])+/).T`template` )
		var js_file = P.seq( P(/(#!.*\n)?/).T`shebang` ,simple_js )
		return code=>{
			var Œπ = js_file.parse(code)._.flatten()
			var r = [] ;for(var t of Œπ) t.T? r.push(t) : r[-1]&&r[-1].T? r.push(t) : (r[-1]+=t)
			return r } })()
	var id_c = alt_ws`filter! map‚Ä¶ map! has‚Ä¶ get‚Ä¶ set‚Ä¶ join? join2? ‚Åª¬πuniq _0_œÜ_seenbydevice0‚Åª¬π then‚öì ‚Åª¬π ‚à™! ‚à©! -! ?? *? +? ‚à™ ‚à© ‚äï ‚Äñ ‚öì -= += ? * + & | ‚àÉ √ó ! -0 -1 -2 -3 -4 - üîí ‚Ä¶`
	var id_num = alt_ws`0 1 2 3 4`
	var Œ∂_compile_nonliteral = Œπ=> Œπ
		.replace(/ifŒî!/g,'ifŒîbang')
		.replace(/\b([0-9]+(?:\.[0-9]+)?)d/g,(À£,Œπ)=> `(${Œπ}*86400)` )
		.replace(êÖÇêÖÇêÖÉêÖùêÖ¶||(êÖÇêÖÇêÖÉêÖùêÖ¶= re`\.?@@(${word}+)`.g ),'[Symbol.$1]')
		.replace(/@/g,'this')
		.replace(/(=>|[=‚Üê:(,?]) *(?!\.\.\.)(‚Äò?\.)/g,(À£,a,b)=> a+'(êÖ≠êÖû)=>êÖ≠êÖû'+b )
		.replace(êÖÉêÖ™êÖúêÖ´êÖÆ||(êÖÉêÖ™êÖúêÖ´êÖÆ= re`‚Äò\.(${word}+)`.g ),(À£,Œπ)=> js`|> (Œπ=> new Property(Œπ,${Œπ}))` )
		.replace(/‚Äò(?=\[)/g ,`|> (o=>( êÖãêÖ®êÖ¶êÖ®êÖ≠ = o ,êÖØêÖ≠êÖùêÖ®êÖÆ ))` )
		.replace(êÖ¶êÖûêÖÉêÖùêÖ™||(êÖ¶êÖûêÖÉêÖùêÖ™= re`(\.)?(${alt_s([...postfix])})(?=\s*([(:])?)`.g ),(À£,dot,id,right)=>0?0: { undefined:js`Œ≥[${id}]` ,'(':js`[Œ≥[${id}]]` ,':':js`${id}` }[dot?'(':right] )
		.replace(/‚úì/g,'true')
		.replace(/‚úó/g,'false')
		.replace(/‚àÖ/g,'undefined')
		.replace(êÖãêÖùêÖûêÖ¨êÖ∞||(êÖãêÖùêÖûêÖ¨êÖ∞= re`üè∑(${word}+)(\s*)‚Üê`.g ),(À£,Œπ,s)=> js`‚Ä¶${Œπ+s}‚Üê êÖØêÖÆêÖ¶êÖ¨êÖÇ(__name(${Œπ})).Œπ=`) // an initial try ;probably .name inference needs another form
		.replace(/‚Äòlexical_env/g,`êÖØêÖÆêÖ¶êÖ¨êÖÇ(Œπ=> Œπ.eval_in_lexical_env= Œπ=>eval(Œπ) ).Œπ=`)
		.replace(/‚ÄΩ(?!\(|`| = \(‚Ä¶a\)=>)/g,'‚ÄΩ()')
		.replace(êÖ®êÖãêÖ¶êÖúêÖ¶||(êÖ®êÖãêÖ¶êÖúêÖ¶= re`(\[(?:${word}|[,‚Ä¶])+\]|\{(?:${word}|[,:‚Ä¶])+\}|${word}+)(\s*)‚Üê(?=[ \t]*(;|of\b|in\b)?)`.g ),(À£,name,ws,eq0)=> 'var '+name+ws+(eq0?'':'=') )
		.replace(/Œª(?=\*?(?:[ \t][^\(=‚Üê]*)?\([^\)]*\)[ \t]*\{)/g,'function')
		.replace(êÖ™êÖØêÖØêÖØêÖ¶||(êÖ™êÖØêÖØêÖØêÖ¶= re`\.\.(${id_num})`.g ),(À£,Œπ)=> `[${Œπ}]`)
		.replace(êÖ©êÖúêÖÉêÖ©êÖ™||(êÖ©êÖúêÖÉêÖ©êÖ™= re`\.(${id_c})`.g ),(À£,Œπ)=> js`[${Œπ}]`)
		.replace(êÖùêÖ©êÖ≠êÖ™êÖÉ||(êÖùêÖ©êÖ≠êÖ™êÖÉ= re`(${id_c}):`.g ),(À£,Œπ)=> js`${Œπ}:`)
		.replace(/‚Ä¶/g,'...')
		// ! this is going to be really hard to take out
			.replace(/(['"])map\.\.\.\1/g,`'map‚Ä¶'`)
			.replace(/(['"])has\.\.\.\1/g,`'has‚Ä¶'`)
			.replace(/(['"])get\.\.\.\1/g,`'get‚Ä¶'`)
			.replace(/(['"])set\.\.\.\1/g,`'set‚Ä¶'`)
			.replace(/(['"])\.\.\.((?:‚Üê\|?)?)\1/g,`'‚Ä¶$2'`)
			// .replace(/\.‚Äòthis/g,'["‚Äò@"]')
		.replace(/‚àû/g,'Infinity')
		.replace(/‚áí(\s*([:{]))?/g,(À£,x,Œπ)=> '=>'+({ ':':'0?0' ,'{':'0?0:' }[Œπ]||_interrobang_())+x )
		.replace(êÖ≠êÖ¶êÖ´êÖ©êÖù||(êÖ≠êÖ¶êÖ´êÖ©êÖù= re`(^|(?!${word})[^\s\)]\s*)(=>(?:\s*=>)*)`.g ),(À£,t,Œπ)=> t+'()=>'["√ó"](Œπ.match(/=>/g)["‚Äñ"]))
		.replace(/‚Ü© ?/g,'return ')
		.replace(/([^]|^)\^/g,(À£,Œπ)=> Œπ==='b'? '^' : Œπ+'**' )
		.replace(êÖ®êÖÇêÖ´êÖØêÖÉ||(êÖ®êÖÇêÖ´êÖØêÖÉ= re`#swap ((?:${word}|[.])+) ((?:${word}|[.])+)`.g ),(À£,a,b)=>{ var t = '_'+_game_die_id.greek(9) ;return Œ∂_compile_nonliteral(`for(;;){ ${t} ‚Üê ${a} ;${a} = ${b} ;${b} = ${t} ;break}`) }) // why not just [a,b] = [b,a]?
		.replace(/\[#persist_here (.*?)\]/g,(À£,Œπ)=> '('+json2_read+js`)(${json2_show(œÜ(Œπ).buf)})`)
		.replace(êÖ≠êÖãêÖ¶êÖùêÖú||(êÖ≠êÖãêÖ¶êÖùêÖú= re`${word_extra}+`.g ) ,unicode_names.X)
		.replace(/([{([]\s*),/g,'$1')
		.replace(êÖÆêÖ∞êÖ∞êÖùêÖ≠||(êÖÆêÖ∞êÖ∞êÖùêÖ≠= re`return\s+var\s+(${word}+)`.g ),(À£,Œπ)=> `var ${Œπ} ;return ${Œπ}`)
		.replace(/(^|(?:^|(?:^|(?:^|(?!new ).).).)(?![.\w]|êÖØ).)Set(?=\()/gm,(À£,a)=> a+'êÖØSet')
	var Œ∂_compile = memoize_tick(code=>{
		// ! it is a clumsy hack to put this on all of these code paths
		var t = code ;t = /^(\{|Œª\s*\()/.test(t)? '0?0: '+t : t ;if( /^(\{|Œª\s*\()/.test(t) ) t = '0?0: '+t
	
		var r = Œ∂_parse(t)

		// you fucker
		var getêÖÉêÖ∞êÖ¶êÖ© = i=> i+2 < r["‚Äñ"]? [i,i+1,i+2].map(i=> r[i]).every((êÖ≠êÖû)=>êÖ≠êÖû.T==='template')? r[i+1].Œπ : undefined : undefined
		for(var i=0;i<r["‚Äñ"];i++) if( Tstr(r[i]) && r[i].endsWith('npm') && getêÖÉêÖ∞êÖ¶êÖ©(i+1)!==undefined && getêÖÉêÖ∞êÖ¶êÖ©(i+1).includes('@') )
			{ ;r[i] = r[i].replace(/npm$/,'') ;r[i+1] = `require(` ;r[i+2] = { T:'js',Œπ:`'${npm_init(r[i+2].Œπ)}'` } ; r[i+3] = `)` }
		var êÖ¶êÖ¶êÖ®êÖ™ = Œπ=> ( t[0]==='¬ß'? Œ∂_compile('¬ß1')+'('+JSON.stringify(_section_sign_0(Œπ))+')' : Œ∂_compile(t[0])+'`'+Œπ+'`' ) + (Œπ.re`:$`?'._=':'')
		for(var i=0;i<r["‚Äñ"];i++) if( Tstr(r[i]) && (t= r[i].match(/¬ß\w*$/)) && getêÖÉêÖ∞êÖ¶êÖ©(i+1)!==undefined )
			{ ;r[i] = r[i].replace(/¬ß\w*$/,'') ;r[i+1] = { T:'js',Œπ:êÖ¶êÖ¶êÖ®êÖ™(getêÖÉêÖ∞êÖ¶êÖ©(i+1)) } ;r[i+2] = r[i+3] = '' }

		return r.map(Œπ=>0?0
			: Œπ.T==='comment'? Œπ.Œπ.replace(/^#/,'//')
			: Œπ.T? Œπ.Œπ
			: Œ∂_compile_nonliteral(Œπ) ).join('') })
	Œ∂_compile["‚Åª¬π"] = Œπ=> Œπ.replace(/\b(?:function|return|this)\b(?!['"])|\bvar \s*([\w_$Œë-Œ°Œ£-Œ©Œ±-œâ]+)(\s*)(=?)|\.\.\./g ,(Œπ,name,s,eq)=>0?0: {'function':'Œª','return':'‚Ü©','this':'@','...':'‚Ä¶'}[Œπ] || (eq==='='? name+s+'‚Üê' : name+s+'‚Üê;') )
	return Œ∂_compile }

if( require.extensions && !require.extensions['.Œ∂'] )(()=>{
	require.extensions['.Œ∂'] = (module,Œπ)=> module._compile(Œ∂_compile(node.fs.readFileSync(Œπ,'utf8')),Œπ)
	var super_ = require.extensions['.js'] ;require.extensions['.js'] = (module,Œπ)=>{ (node.path.extname(Œπ)==='' && node.fs.readFileSync(Œπ,'utf8').re`#!/usr/bin/env Œ∂\s`? require.extensions['.Œ∂'] : super_)(module,Œπ) }
	})()

//################################### prelude ###################################
Œ≥.protos = function*(Œπ){ for(;!( Œπ===null || Œπ===undefined ) ;Œπ = Object.getPrototypeOf(Œπ)) yield Œπ }

Œ≥.simple_flesh = Œπ=> Tfun(Œπ)? T(Œπ)+Œπ : JSON.stringify(Œπ,(À£,Œπ)=>{ if( Tprim(Œπ)||Tarr(Œπ)) return Œπ ;else{ var r={} ;_l.keys(Œπ).sort().forEach(i=> r[i]=Œπ[i]) ;return r } })
	// a shame this doesnt include json2_show s work at all ... gonna be slow on buffers
	// try{ ... }catch(e){ e.message==='Converting circular structure to JSON' || ‚ÄΩ(e) ;‚Ü© npm`circular-json@0.4.0`.stringify(Œπ) } }
Œ≥[Œ≥["|>"]] (Œπ=> new Property(Œπ,"simple_hash")) .thunk=()=>{
	var bigintstr_to_buf = Œπ=>{ ;var Œπ = require('/usr/local/lib/êÖ™êÖ©modu/big-integer@1.6.26__57/node_modules/big-integer')(Œπ) ;var r = Buffer.alloc(8) ;r.writeUInt32BE( +Œπ.shiftLeft(-32) ,0 ) ;r.writeUInt32BE( +Œπ.and(2**32-1) ,4 ) ;return r }
	var buf36 = require('/usr/local/lib/êÖ™êÖ©modu/base-x@1.0.4__57/node_modules/base-x')([.../[0-9a-z]/].join('')).encode
	var farmhash_stable_64 = require('/usr/local/lib/êÖ™êÖ©modu/farmhash@2.0.4__57/node_modules/farmhash').fingerprint64 [Œ≥["‚â´"]] (bigintstr_to_buf)
	return simple_flesh [Œ≥["‚â´"]] (Buffer.from) [Œ≥["‚â´"]] (farmhash_stable_64) [Œ≥["‚â´"]] (buf36) [Œ≥["‚â´"]] ((êÖ≠êÖû)=>êÖ≠êÖû.padStart(13,'0').slice(1)) }

Œ≥.poll1_simple = f=> Œ†(re=>{
	var êÖ©êÖ´êÖÇêÖ¨ = (function*(){ yield 0 ;var Œπ = 0.01 ;yield Œπ ;yield* _midline_horizontal_ellipsis_(12).map(()=> Œπ *= 1.5 ) ;yield* _midline_horizontal_ellipsis_(10).map(()=> 1) ;yield* _midline_horizontal_ellipsis_(10).map(()=> 5) ;for(;;) yield 30 })() [Œ≥["|>"]](seq)
	var êÖÇ = ()=> (()=>{ var t = f() ;t===undefined||t===null? êÖÇ() : re(t) }).in(êÖ©êÖ´êÖÇêÖ¨.next_Œπ) ;êÖÇ() })

Œ≥.thisdevice_memo = f=>{
	var d = thisdevice0('êÖ¶êÖÉêÖÇêÖÇ'+simple_hash(f)) ;var d_ = d.Œπ||{} ;var êÖ™êÖãêÖÉêÖ® = (t,Œπ)=>( Œπ.Œπ = t ,d.Œπ = d_ ,d_ = d.Œπ ,Œπ.Œπ )
	return (...a)=>{var t; var Œπ = d_[Œ≥["|>"]] (o=>( êÖãêÖ®êÖ¶êÖ®êÖ≠ = o ,êÖØêÖ≠êÖùêÖ®êÖÆ ))[simple_hash(a)] ;return Œπ["‚àÉ"]? Œπ.Œπ : T.Promise(t= f(...a) )? t.union.then(t=> êÖ™êÖãêÖÉêÖ®(t,Œπ)) : êÖ™êÖãêÖÉêÖ®(t,Œπ) } }
	// may race condition but is unlikely & relatively harmless
	// it would be lovely if this s could use data from their previous versions
	// the Promise addition makes race conditions way more likely

Œ≥.unicode_names = Œπ=> [...Œπ].map(thisdevice_memo(Œπ=>
	(êÖ©êÖ©êÖ©êÖùêÖã||(êÖ©êÖ©êÖ©êÖùêÖã= (()=>{
		var unicode = npm('unicode@10.0.0','/category') [Œ≥["|>"]](_l.values) ['map‚Ä¶'](_l.values)
		return unicode.filter(Œπ=> !/^</.test(Œπ.name)).map(Œπ=>[ parseInt(Œπ.value,16) ,'_'+Œπ.name.replace(/[- ]/g,'_').toLowerCase()+'_' ])._.object()
		})() ) )[ord(Œπ)]).X).join('') ;var êÖ©êÖ©êÖ©êÖùêÖã;

//########## parsers and such ###########
Œ≥[Œ≥["|>"]] (Œπ=> new Property(Œπ,"regex_parse_0")) .thunk=()=>{var t; // soon to be deprecated
	var P = require('./parsimmon2.js')
	var êÖ¨êÖ¨ = Œπ=> chr(parseInt(Œπ,16))
	var ESCAPE = P('\\').then(P.alt( P(/x([0-9a-fA-F]{2})/,1).map(êÖ¨êÖ¨) ,P(/u\{([0-9a-fA-F]+)\}/,1).map(êÖ¨êÖ¨) ,P(/u([0-9a-fA-F]{4})/,1).map(êÖ¨êÖ¨) ,P(/./).map(Œπ=> '.[|^$()*+?{}\\/'.includes(Œπ)? Œπ : P.T('escape',Œπ) ) ))
	var s1 = P.alt(
		P(/[^.()[\]^$|\\]/)
		,ESCAPE
		,P`.`.T`any`
		,P`(?:${()=>OR_or_SEQ})`
		,P`(?=${()=>OR_or_SEQ})`.T`lookahead`
		,P`(?!${()=>OR_or_SEQ})`.T`nlookahead`
		,P`(${()=>OR_or_SEQ})`.T`capture`
		,P`[${[ /\^?/ ,( t= ESCAPE.or(/[^\]]/) ,P([ t.skip('-') ,t ]).or(t) ).many() ]}]`.map(Œπ=> P.T(Œπ[0]? 'nset' : 'set' ,Œπ[1]))
		)
	var TIMES = P([ s1 ,P.alt('*','+','?',/\{([0-9]+)(?:(,)([0-9]*))?\}/,P.of())
		.map(Œπ=> Œπ = !Œπ? Œπ : Œπ==='*'? [0,Infinity] : Œπ==='+'? [1,Infinity] : Œπ==='?'? [0,1] : (()=>{ var [À£,a,two,b] = Œπ.match(/\{([0-9]+)(?:(,)([0-9]*))?\}/) ;return [a|0,b? b|0 : two? Infinity : a|0] })() )
		]).map(([Œπ,for_])=> !for_? Œπ : {T:'times' ,Œπ ,for:for_} )
	var s2 = P.alt( P('^').T`begin` ,P('$').T`end` ,TIMES )
	var OR_or_SEQ = P.sep_by(s2.many().T`seq` ,'|').map(Œπ=> Œπ["‚Äñ"] > 1? P.T('or',Œπ) : Œπ[0])
	return Œπ=>0?0: {Œπ:OR_or_SEQ.parse(Œπ.source) ,flags:Œπ.flags} }
Œ≥[Œ≥["|>"]] (Œπ=> new Property(Œπ,"applescript")) .thunk=()=>0?0: {
	parse: (()=>{
	  var P = require('./parsimmon2.js')
	  var ws = Œπ=> ws_.then(Œπ).skip(ws_) ;var ws_ = P(/[ \t\n\r]*/)
	  var value = P(()=> P.alt(false_,true_,number,object,array,string,raw) )
	  var false_ = P('false').map(()=> false)
	  var true_ = P('true').map(()=> true)
	  var number = P(/-?(0|[1-9][0-9]*)(\.[0-9]+)?([eE][-+]?[0-9]+)?/).map(Œπ=> +Œπ)
	  var _member = P.seq(P(/[ a-z0-9-]+/i).skip(ws(P(':'))) ,value)
	  var object = ws(P('{')).then(P.sep_by(_member,ws(P(',')))).skip(ws(P('}'))).map(Œπ=> Œπ["‚Äñ"]? _u.object(Œπ) : [])
	  var array = ws(P('{')).then(P.sep_by(value,ws(P(',')))).skip(ws(P('}')))
	  var _char = P(/[\n\t\x20-\x21\x23-\x5B\x5D-\u{10FFFF}]|\\(["\\\/bfnrt]|u[0-9a-fA-F]{4})/u).map(Œπ=> Œπ[0]!=='\\'? Œπ : {'"':'"','\\':'\\','/':'/',b:'\b',f:'\f',n:'\n',r:'\r',t:'\t'}[Œπ[1]] || chr(parseInt(Œπ.slice(2),16)) )
	  var string = P('"').then( _char.many().map((êÖ≠êÖû)=>êÖ≠êÖû.join('')) ).skip(P('"'))
	  var raw = P(/[^,}"]+/).or(string.map_js((Œπ,[i0,i1],l)=> l.slice(i0,i1))).many().map(Œπ=>{ Œπ=Œπ.join('') ;return Œπ==='missing value'? undefined : {T:'raw',Œπ} })
	  return Œπ=> Œπ===''? undefined : ws(value).parse(Œπ) })()
	,print: Œπ=> Tnum(Œπ)? Œπ+'' : Tstr(Œπ)? '"'+Œπ.replace(/["\\]/g,'\\$&')+'"' : Tarr(Œπ)? '{'+Œπ.map(applescript.print.X).join(',')+'}' : _interrobang_()
	}

var genex = function Œõ(Œπ){return 0?0
	: Tstr(Œπ)? [Œπ]
	: Œπ.flags!==undefined?( Œπ.flags.replace(/u/,'') && _interrobang_() ,Œõ(Œπ.Œπ) )
	: Œπ.T==='capture'? Œõ(Œπ.Œπ)
	: Œπ.T==='escape'? _interrobang_()
	: Œπ.T==='or'? Œπ.Œπ['map‚Ä¶'](Œõ)
	: Œπ.T==='seq'? cartesian(...Œπ.Œπ.map(Œõ)).map((êÖ≠êÖû)=>êÖ≠êÖû.join(''))
	// : Œπ.T==='times'? # Œõ(Œπ.Œπ).map‚Ä¶(x=> _l.range(Œπ.for[0],Œπ.for[1]+1).map(i=> x.√ó(i)) )
	// 	Œπs ‚Üê Œõ(Œπ.Œπ)
	: Œπ.T==='set'? Œπ.Œπ['map‚Ä¶'](Œπ=>0?0
		: Tarr(Œπ)? _l.range(ord(Œπ[0]),ord(Œπ[1])+1).map(chr)
		: Œπ.T==='escape'? _interrobang_()
		: [Œπ] )
	: _interrobang_(Œπ) }

//#######################################
Œ≥ [Œ≥['‚Ä¶‚Üê']](_u(Math).pick('abs','ceil','exp','floor','log10','log2','max','min','round','sqrt','cos','sin','tan'),{ ln:Math.log ,œÄ:Math.PI ,œÑ:Math.PI*2 ,e:Math.E ,'‚çü':Math.log })
Œ≥._game_die_ = function(Œπ){return arguments.length===0? Math.random() : Tnum(Œπ)? _game_die_()*Œπ |0 : _l.sample(Œπ) }
Œ≥[Œ≥["|>"]] (Œπ=> new Property(Œπ,"_game_die_id")) .thunk=()=>{
	var t = Œ±Œ≤=> (L=> L.map(()=> _game_die_(Œ±Œ≤)).join('')) [Œ≥['‚Ä¶‚Üê']] ({Œ±Œ≤})
	var _game_die_id = t([.../[0-9a-z]/])
	_game_die_id.braille = t([...re`[‚†Å-‚£ø]`]) // [‚†Ä-‚£ø]
	_game_die_id.greek = t([...'êÖÇêÖÉêÖãêÖúêÖùêÖûêÖ¶êÖ®êÖ©êÖ™êÖ´êÖ¨êÖ≠êÖÆêÖØêÖ∞'])
	return _game_die_id }

Œ≥.ord = (Œπ,i)=> Tnum(Œπ)? Œπ : Œπ.codePointAt(i)
Œ≥.chr = Œπ=> Tstr(Œπ)? Œπ : String.fromCodePoint(Œπ)

var êÖØêÖ©êÖ™êÖ®êÖÉ = function*(Œ∏){ for(;Œ∏.i<Œ∏.l["‚Äñ"];) yield Œ∏.l[Œ∏.i++] }
Œ≥.seq = Œπ=>{
	var r = new_(seq)
	if( Tarr(Œπ) ){ ;r.Œπ = êÖØêÖ©êÖ™êÖ®êÖÉ(r) ;r.i = 0 ;r.l = Œπ }
	else if( !Œπ.next ) r.Œπ = Œπ[Symbol.iterator]()
	else r.Œπ = Œπ
	return r }
seq.prototype = {
	Œπ:undefined ,i:undefined ,l:undefined
	,map:function*(f){ for(var t of this.Œπ) yield f(t) }
	// ,'map‚Ä¶':Œª(){} ,fold(){} ,√ó(){} ,filter(){} ,pin(){} ,find_(){} ,slice(){} ,'‚Äñ':Œª(){} ,some(){} ,every(){}
	,get next_Œπ(){return this.Œπ.next().value }
	,get next_ŒπŒπ(){ var t = this.Œπ.next() ;if( t.done )return ;t = t.value ;t===undefined && _interrobang_() ;return t }
	,get clone(){ var t= seq(this.l) ;t.i= this.i ;return t }
	}
seq.cartesian = (...Œπ)=> êÖÆêÖãêÖÆêÖØ(Œπ) ;var êÖÆêÖãêÖÆêÖØ = function*(Œπ,i=0){ if( Œπ.length-i===0 ) yield [] ;else for(var b of Œπ[i]) for(var c of êÖÆêÖãêÖÆêÖØ(Œπ,i+1)) yield [b,...c] }
Œ≥.cartesian = (...Œπ)=> [...seq.cartesian(...Œπ)]
// (Œª*(){ yield 5 })().next()
// Object.getOwnPropertyDescriptors([‚Ä¶protos(Œª*(){}())][2])
// [‚Ä¶protos(Set())].map(Object.getOwnPropertyDescriptors)
// [‚Ä¶protos(Set().@@iterator())].map(Object.getOwnPropertyDescriptors)
// ok,,,, the cloneability property desired here is fundamentally impossible .yay

Œ≥._midline_horizontal_ellipsis_ = Œπ=> _l.range(Œπ)
Œ≥._almost_equal_to_ = (a,b)=> _l.isEqualWith(a,b,(a,b)=> T.Buffer(a) && T.Buffer(b)? a.equals(b) : undefined )
Œ≥._not_almost_equal_to_ = (a,b)=> ! _almost_equal_to_(a,b)
Œ≥.zip_min = (a,b)=> _l.zip( a["‚Äñ"]>b["‚Äñ"]? a.slice(0,b["‚Äñ"]) : a , a["‚Äñ"]<b["‚Äñ"]? b.slice(0,a["‚Äñ"]) : b )
Œ≥.Œîset = (a,b)=> new Map([ ... a["-"](b).map(Œπ=>[Œπ,-1]) ,... b["-"](a).map(Œπ=>[Œπ,1]) ]) // assume uniq

_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Set","Map"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"_"}]},null]}])._={ get(){return _u(this)} }

_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Buffer","String","Function"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"‚Äñ"}]},null]}])._={ get(){return this.length } }
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Set","Map"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"‚Äñ"}]},null]}])._={ get(){return this.size } }

// goal: replace `map` with `‚â´` everywhere .implementation slowed in hope for clarity wrt lists in the future of See
// 'Array.prototype.map'
// ,'Buffer.prototype.map':Œª(f){ r ‚Üê Buffer.alloc(@.‚Äñ) ;for(i‚Üê0;i<@.‚Äñ;i++) r.push(f(@[i])) ;‚Ü© r } does not even work
Set.prototype.map = function(f){return [...this].map(f) }
Map.prototype.map = function(f){return [...this.entries()].map(([i,Œπ])=> f(Œπ,i,this)) }
Number.prototype.map = function(f){'use strict' ;var Œπ=+this ;var r = Array(Œπ) ;for(var i=0;i<Œπ;i++) r[i] = f(i,i,Œπ) ;return r }

Array.prototype.map_ = Array.prototype.map
Set.prototype.map_ = function(f){return new Set([...this].map(f)) }
Map.prototype.map_ = function(f){return new Map([...this.entries()].map(f)) }

_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Set","Map"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"some"}]},null]}])._=function(f){return [...this].some(f) }
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Set","Map"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"every"}]},null]}])._=function(f){return [...this].every(f) }

Array.prototype['map‚Ä¶'] = function(f){ var r = [] ;for(var i=0;i<this["‚Äñ"];i++) r.push(...f(this[i],i,this)) ;return r }
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Set","Map","Number"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"map‚Ä¶"}]},null]}])._=function(f){return this.map(f)['‚Ä¶'] }

Set.prototype.filter = function(f){return êÖØSet(...[...this].filter(f)) }

Array.prototype.edge_comple = function(f){ var êÖÉêÖù={}; var r = [] ;for(var Œπ of this){ var t = f(Œπ) ;t===êÖÉêÖù ||( êÖÉêÖù= t ,r.push([]) ) ;r[-1].push(Œπ) } ;return r }
Set.prototype.partition = function(f){return _u([...this]).partition(f).map(Œπ=> êÖØSet(...Œπ)) }

Array.prototype[Œ≥["|>"]] (o=>( êÖãêÖ®êÖ¶êÖ®êÖ≠ = o ,êÖØêÖ≠êÖùêÖ®êÖÆ ))['‚Ä¶'] .host= { get(){return this['map‚Ä¶'](Œπ=>Œπ) } }

Array.prototype.fold = Array.prototype.reduce
Array.prototype.foldr = Array.prototype.reduceRight

Array.prototype.repeat = function(x){return x<=0? [] : x['map‚Ä¶'](()=> this) }
Buffer.prototype.repeat = function(x){return Buffer.concat(x<=0? [] : x.map(()=> this)) }

// ,'String.prototype.trim':Œª(Œπ=/\s+/)){‚Ü© @.replace(re`^${Œπ}|${Œπ}$`.g,'') }
Array.prototype.trim = function(Œπ){ var a = this[0]===Œπ ;var b = this[-1]===Œπ ;return !(a||b)? this : this.slice( a?1:0 ,b?"-1":this["‚Äñ"] )}

String.prototype["√ó"] = String.prototype.repeat
Array.prototype["√ó"] = function(x){return 0?0
	: Tnum(x)? x<=0? [] : x['map‚Ä¶'](()=> this)
	: Tarr(x)? this['map‚Ä¶'](a=> x.map(b=> [a,b] ))
	: _interrobang_() }
Buffer.prototype["√ó"] = function(x){return Buffer.concat(x<=0? [] : x.map(()=> this)) }

Set.prototype.join = function(Œπ){return [...this].join(Œπ) }

_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Buffer","String","Set"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"count"}]},null]}])._=function(){ var r = new Map() ;for (var t of this) r.set(t ,(r.has(t)? r.get(t) : 0)+1 ) ;return r }
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Buffer","String","Set"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"group"}]},null]}])._=function(f){ f||(f = Œπ=>Œπ) ;var r = new Map() ;for (var t of this){ ;var t2 = f(t) ;var t3 = r.get(t2) ||( r.set(t2,t3=êÖØSet()) ,t3 ) ;t3.add(t) } ;return r }
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Buffer","String","Set"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"group_uniq"}]},null]}])._=function(f){ f||(f = Œπ=>Œπ) ;var r = new Map() ;for (var Œπ of this){ var t = f(Œπ) ;r.has(t) && _interrobang_() ;r.set(t,Œπ) } ;return r }
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Buffer","String","Set"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"group_uniq_reduce"}]},null]}])._=function(f){ f||(f = Œπ=>Œπ) ;var r = new Map() ;for (var t of this) r.set(f(t),t) ;return r }

Map.prototype.zip = function(...a){ a.unshift(this) ;var r = new Map() ;a.forEach((Œπ,i)=> Œπ.forEach((Œπ,k)=>{ var t = r.get(k) || [undefined]["√ó"](a["‚Äñ"]) ;t[i] = Œπ ;r.set(k,t) })) ;return r }
// ! what is this? what does it do?

_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Buffer","String"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"chunk"}]},null]}])._=function(L){return _l.range(0,this["‚Äñ"],L).map(i=> this.slice(i,i+L)) }
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Buffer","String"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"windows"}]},null]}])._=function(L){return (this["‚Äñ"]-L+1).map(i=> this.slice(i,i+L)) }
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Buffer","String"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"-1"}]},null]}])._={get(){return this["‚Äñ"]<1? undefined : this[this["‚Äñ"]-1] },set(Œπ){ this["‚Äñ"]<1 || (this[this["‚Äñ"]-1] = Œπ) }}
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Buffer","String"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"-2"}]},null]}])._={get(){return this["‚Äñ"]<2? undefined : this[this["‚Äñ"]-2] },set(Œπ){ this["‚Äñ"]<2 || (this[this["‚Äñ"]-2] = Œπ) }}
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Buffer","String"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"-3"}]},null]}])._={get(){return this["‚Äñ"]<3? undefined : this[this["‚Äñ"]-3] },set(Œπ){ this["‚Äñ"]<3 || (this[this["‚Äñ"]-3] = Œπ) }}
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Buffer","String"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"-4"}]},null]}])._={get(){return this["‚Äñ"]<4? undefined : this[this["‚Äñ"]-4] },set(Œπ){ this["‚Äñ"]<4 || (this[this["‚Äñ"]-4] = Œπ) }}

_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Set"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"‚à™"}]},null]}])._=function(...a){return new Set([this,...a]['‚Ä¶']) }
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Set"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"‚à©"}]},null]}])._=function(...a){ var r = new Set(this) ;for(var x of a){ x = T.Set(x)? x : new Set(x) ;for(var Œπ of r) x.has(Œπ) || r.delete(Œπ) } ;return r }
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Set"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"-"}]},null]}])._=function(...a){return new Set(this)["-!"](...a) }
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Set"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"‚äï"}]},null]}])._=function(b){var a=this ;return a["-"](b)["‚à™"](b["-"](a)) }
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Set"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"‚à™!"}]},null]}])._=function(...a){ for(var b of a) for(var Œπ of b) this.add(Œπ) ;return this }
// ¬ß`{Array Set}.prototype.'‚à©!' :`Œª(‚Ä¶a){
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Set"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"-!"}]},null]}])._=function(...a){ for(var t of a) for(var Œπ of t) this.delete(Œπ) ;return this }
// ¬ß`{Array Set}.prototype.'‚äï!' :`Œª(‚Ä¶a){

Map.prototype['has‚Ä¶'] = function(...as){var Œπ=this ;as["‚Äñ"]>=1||_interrobang_() ;var _1 = as.pop() ;for(var a of as){ if(!Œπ.has(a))return ;Œπ = Œπ.get(a) } ;return Œπ.has(_1) }
Map.prototype['get‚Ä¶'] = function(...as){var Œπ=this ;for(var a of as){ if(!Œπ.has(a))return ;Œπ = Œπ.get(a) } ;return Œπ }
Map.prototype['set‚Ä¶'] = function(...as){var t;var Œπ=this ;as["‚Äñ"]>=2||_interrobang_() ;var v = as.pop() ;var _1 = as.pop() ;for(var a of as) Œπ = Œπ.has(a)? Œπ.get(a) : (Œπ.set(a,t=new Map()),t) ;Œπ.set(_1,v) ;return v }
// Map.prototype.| = Œª(f){‚Ü© ((‚Ä¶Œπ)=> @.has‚Ä¶(‚Ä¶Œπ)? @.get‚Ä¶(‚Ä¶Œπ) : f(‚Ä¶Œπ)) ‚Ä¶‚Üê([@,f]) ‚Ä¶‚Üê({set‚Ä¶:(‚Ä¶Œπ)=>@.set‚Ä¶(‚Ä¶Œπ)}) }

_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Set","Map"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"filter!"}]},null]}])._=function(f){ this.forEach((Œπ,i)=> f(Œπ,i,this) || this.delete(i)) }
Set.prototype.pop = function(){ var t = this[0] ;this.delete(t) ;return t }
Set.prototype[Œ≥["|>"]] (o=>( êÖãêÖ®êÖ¶êÖ®êÖ≠ = o ,êÖØêÖ≠êÖùêÖ®êÖÆ ))[0] .host= {get(){return seq(this).next_Œπ }}
_section_sign_1([{"tag":":","Œπ":[{"tag":".","Œπ":[{"tag":".","Œπ":[{"tag":"{}","Œπ":[null,"Array","Set"]},{"tag":"string","Œπ":"prototype"}]},{"tag":"string","Œπ":"-eq"}]},null]}])._=function(...a){ var t = _u([...this]).groupBy(simple_flesh) ;a.forEach((êÖ≠êÖû)=>êÖ≠êÖû.forEach(Œπ=> delete t[simple_flesh(Œπ)])) ;return _l.values(t)['‚Ä¶'] }

Map.prototype[Œ≥["|>"]] (o=>( êÖãêÖ®êÖ¶êÖ®êÖ≠ = o ,êÖØêÖ≠êÖùêÖ®êÖÆ ))['‚Åª¬πuniq'] .host= {get(){return new Map([...this.entries()].map(([a,b])=>[b,a])) }}
Map.prototype[Œ≥["|>"]] (o=>( êÖãêÖ®êÖ¶êÖ®êÖ≠ = o ,êÖØêÖ≠êÖùêÖ®êÖÆ ))['‚Åª¬π'] .host= {get(){return [...this.keys()].group(Œπ=> this.get(Œπ)) }}

Array.prototype.find_ = function(f){ var r; if( this.some(function(Œπ,i,o){var t; if( (t= f(Œπ,i,o))!==undefined ){ r = [i,Œπ,t] ;return true } })) return r }
Array.prototype.find_index_deep = function(f){
	for(var i=0;i<this["‚Äñ"];i++){ var Œπ = this[i]
		if( Tarr(Œπ)){ var t = Œπ.find_index_deep(f) ;if( t) return [i,...t] }
		else{ if( f(Œπ) )return [i] }
		} }
Array.prototype.find_last_index = function(f){ for(var i=this["‚Äñ"]-1;i>=0;i--) if( f(this[i],i,this) ) return i }
Array.prototype.join_ = function(...s){ var r= [] ;var _0= true ;for(var t of this) _0?( _0= false ,r.push(t) ): r.push(...s,t) ;return r }

// ,'Set.prototype.@@iterator':Set.prototype.values
// ,'Map.prototype.@@iterator':Map.prototype.entries
RegExp.prototype[Symbol.iterator] = function*(){yield* genex(regex_parse_0(this)) }
RegExp.prototype.exec_at = function(Œπ,i){ this.lastIndex = i ;return this.exec(Œπ) }

node.stream.Readable.prototype.pin = function(){return Œ†(yes=>{ var t = [] ;this.resume() ;this.on('data',Œπ=> t.push(Œπ) ).on('end',()=> yes(Buffer.concat(t)) ) })}
Buffer.prototype.pipe = function(to,opt){ var t = new node.stream.Duplex() ;t.push(this) ;t.push(null) ;return t.pipe(to,opt) }
node.EventEmitter.prototype.P = function(id){id+='' ;return new_(êÖØêÖúêÖùêÖÉêÖã) [Œ≥['‚Ä¶‚Üê']] ({host:this,id}) }
node.EventEmitter.prototype.Œ† = function(id){return this.P(id).Œ† }

var êÖØêÖúêÖùêÖÉêÖã = { emit(...a){return this.host.emit(this.id,...a) } ,on(f){ this.host.on(this.id,f) ;return this } }
êÖØêÖúêÖùêÖÉêÖã[Œ≥["|>"]] (Œπ=> new Property(Œπ,"Œ†")) [Œ≥['‚Ä¶‚Üê']] ({ get(){return Œ†(yes=> this.host.once(this.id,yes)) } })
Promise.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"status")) .f1Œπ= function(){var get;
	if(get= b_util&&b_util.getPromiseDetails ){ var [r,Œπ] = get(this) ;r = [undefined,true,false][r] ;if( r!==undefined ){ [this.status,this.Œπ] = [r,Œπ] ;return r } }
	else{ var t = r=> Œπ=>{ [this.status,this.Œπ] = [r,Œπ] ;return this.status } ;this.then(t(true),t(false)) ;t(undefined)(undefined) ;return this.status } }
Promise.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"Œπ")) .f1Œπ= function(){ if( this.status!==undefined ) return this.Œπ }
// Promise.prototype[|>] = (Œπ,f)=> Œπ===Promise.prototype? f(Œπ) : Œπ.status? f(Œπ.Œπ) : Œπ.then(f) # breaks things
Promise.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"union")) .get=function(){return this.then(Œπ=>Œπ,Œπ=>Œπ) }

Function.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"X")) [Œ≥["!>"]]((êÖ≠êÖû)=>êÖ≠êÖû.enumerable=false) .get=function(){return Œπ=> this(Œπ) }
Function.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"XX")) [Œ≥["!>"]]((êÖ≠êÖû)=>êÖ≠êÖû.enumerable=false) .get=function(){return (a,b)=> this(a,b) }
Function.prototype.P = function(...a){return this.bind(undefined,...a) }

var TimerCons = function(a,b){this.a=a;this.b=b} ;TimerCons.prototype = { clear:function(){this.a.clear();this.b.clear()} ,ref:function(){this.a.ref();this.b.ref()} ,unref:function(){this.a.unref();this.b.unref()} }
Function.prototype.defer = function(){return setImmediate(this) }
Function.prototype.in = function(time){return setTimeout(this,max(0,time||0)*1e3) }
Function.prototype.in_Œ† = function(time){return Œ†((yes,no)=> setTimeout(()=> Œ†(this()).then(yes,no),(time||0)*1e3)) }
Function.prototype.every = function(time,opt){opt||(opt={}) ;var r = setInterval(this,max(0,time)*1e3) ;return !opt.leading? r : new TimerCons(this.in(0),r) }

Function.prototype[Œ≥["|>"]] (o=>( êÖãêÖ®êÖ¶êÖ®êÖ≠ = o ,êÖØêÖ≠êÖùêÖ®êÖÆ ))['!'] [Œ≥["!>"]]((êÖ≠êÖû)=>êÖ≠êÖû.enumerable=false) .get=function(){return (...a)=> !this(...a) }

;[Set,Map].map(Seq=>
	Object.getPrototypeOf( new Seq().entries() ) [Œ≥['‚Ä¶‚Üê']] ({
		map(f){return [...this].map(f) }
		}) )
var t; Object.getPrototypeOf(( t=setImmediate(()=>{}) ,clearImmediate(t) ,t )) [Œ≥['‚Ä¶‚Üê']] ({
	clear(){ clearImmediate(this) }
	,ref(){} ,unref(){}
	})
var t; Object.getPrototypeOf(( t=setTimeout(()=>{},0) ,clearTimeout(t) ,t )) [Œ≥['‚Ä¶‚Üê']] ({
	clear(){ this._repeat? clearInterval(this) : clearTimeout(this) }
	})

Œ≥.walk = (Œπ,f,k,o)=>( Tprim(Œπ)||_u(Œπ).forEach((Œπ,k,o)=> walk(Œπ,f,k,o)) ,Œπ!==undefined && Œπ!==null && f(Œπ,k,o) ,Œπ )
Œ≥.walk_graph = (Œπ,f,seen=[])=> !( Tprim(Œπ) || seen.includes(Œπ) ) && ( seen.push(Œπ) ,_u(Œπ).forEach(Œπ=> walk_graph(Œπ,f,seen)) ,seen.pop() ,Œπ!==undefined && Œπ!==null && f(Œπ) ,Œπ )
Œ≥.walk_both_obj = (Œπ,f·µÉ,f·µá,fseen,seen=[])=> fseen && seen.includes(Œπ)? fseen(Œπ) : !( Tprim(Œπ) || Tfun(Œπ) || seen.includes(Œπ) ) && ( f·µÉ(Œπ) ,seen.push(Œπ) ,_u(Œπ).forEach(Œπ=> walk_both_obj(Œπ,f·µÉ,f·µá,fseen,seen)) ,seen.pop() ,f·µá(Œπ) ,Œπ )
Œ≥.walk_fold = (Œπ,f,k,o)=> Tprim(Œπ)? Œπ : Tarr(Œπ)? ( Œπ = Œπ.map((Œπ,k,o)=> walk_fold(Œπ,f,k,o)) ,f(Œπ,k,o) ) : ( Œπ = _u(Œπ).map((Œπ,k,o)=> [k,walk_fold(Œπ,f,k,o)])._.object() ,f(Œπ,k,o) ) // has 1 use
Œ≥.walk_obj_edit = (Œπ,f)=> Tprim(Œπ) || Tfun(Œπ)? Œπ : Tarr(Œπ)? Œπ.map(Œπ=> walk_obj_edit(Œπ,f)) : (()=>{ for (var k in Œπ) if( Object.prototype.hasOwnProperty.call(Œπ,k)) Œπ[k] = walk_obj_edit(Œπ[k],f) ;return f(Œπ) })()
Œ≥.search_obj = (Œπ,f)=>{ var r=[] ;walk(Œπ,(Œπ,k,o)=> Œπ!==undefined && Œπ!==null && f(Œπ,k,o) && r.push(Œπ)) ;return r }
Œ≥.search_graph = (Œπ,f)=>{ var r=[] ;walk_graph(Œπ,Œπ=> Œπ!==undefined && Œπ!==null && f(Œπ) && r.push(Œπ)) ;return r }
// the right name for walk is going to be along the lines of
// f /@ x       x.map(f)
// f //@ x      postwalk(x,f) # MapAll
// it could be a data structure that you can fmap over

Œ≥.hrtime = function(Œπ){ var t = arguments.length===0? process.hrtime() : process.hrtime([Œπ|0,(Œπ-(Œπ|0))*1e9]) ;return t[0] + t[1]*1e-9 }
Œ≥.Time = function(Œπ){ var r = arguments.length===0? new Date() : Œπ instanceof Date? Œπ : new Date(Tnum(Œπ)? Œπ*1e3 : Œπ) ;r.toString = function(){return node.util.inspect(this) } ;return r }
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"i")) .get=function(){return +this / 1e3}

Œ≥.cmd_log_loc = cmd=>{
	var id = œÜ(cmd).name+'.'+simple_hash(cmd) ;return { id
		,out:œÜ`~/Library/Caches/Œ∂.logic/${id}.out`.ensure_dir()+''
		,err:œÜ`~/Library/Caches/Œ∂.logic/${id}.err`.ensure_dir()+''
		} }
Œ≥.os_daemon = (cmd,opt)=>{ cmd+='' ;var {once} = opt||{}
	var t = cmd_log_loc(cmd)
	var job = {
		[once?'RunAtLoad':'KeepAlive']:true
		,Label:`Z.${t.id}`
		,ProgramArguments:['sh','-c',sh`export anon_tns7w=${cmd} ;PATH="/usr/local/bin:$PATH" ;${cmd}`]
		,StandardOutPath  :t.out
		,StandardErrorPath:t.err
		}
	var job_path = œÜ`~/Library/LaunchAgents/${job.Label}.plist` ;job_path["‚àÉ"] ||( job_path.Œπ = job ) ;_almost_equal_to_( job_path.plist ,job ) || _interrobang_()
	return { cmd ,job_path ,restart(){ var t = this.job_path ;sh·µ•`launchctl unload ${t} &>/dev/null ;launchctl load ${t}` } } }
os_daemon[Œ≥["|>"]] (Œπ=> new Property(Œπ,"this")) .thunk=()=> process.env.anon_tns7w && os_daemon(process.env.anon_tns7w)

module.__proto__.if_main_do = function(f,b){ !this.parent? f(...process.argv.slice(2)) : b&&b() }

//##### metaprogramming ‚Üí runtime macros built on top of template literals ######
Œ≥.is_template0 = (ss,Œπs)=> ss && Tarr(ss.raw) && ss.raw["‚Äñ"]-1 === Œπs["‚Äñ"]
Œ≥.is_template = ([ss,...Œπs])=> is_template0(ss,Œπs)
var tmpl_flatten = (raw2,Œπs2)=> _l.zip(raw2,Œπs2)['‚Ä¶'].slice(0,-1).filter(Œπ=> Œπ!=='')
Œ≥.simple_template = (ss,Œπs,filter)=>{ is_template0(ss,Œπs) || _interrobang_()
	if( Tarr(filter) ){ var [root,join] = filter ;filter = Œπ=> Tarr(Œπ)? Œπ.map(Œπ=> root`${Œπ}`).join(join) : falsy(Œπ)? '' : undefined }
	var filter_special = Œπ=> falsy(Œπ)? '' : Œπ+''
	var Œπ = tmpl_flatten( ss.raw.map((êÖ≠êÖû)=>êÖ≠êÖû.replace(/\\(?=\$\{|`)/g,'')) ,Œπs.map(Œπ=>0?0:{raw:Œπ}) )
	for(var i=0;i<Œπ["‚Äñ"]-1;i++) if( Tstr(Œπ[i]) && !Tstr(Œπ[i+1])) Œπ[i] = Œπ[i].replace(/‚Ä¶$/,()=>{ Œπ[i+1] = filter_special(Œπ[i+1].raw) ;i++ ;return '' })
	filter &&( Œπ = Œπ.map(Œπ=> Tstr(Œπ)? Œπ : orundefined(filter(Œπ.raw),Œπ) ) )
	return Œπ }
Œ≥.easy_template = (()=>{
	var read = (ss,Œπs)=> tmpl_flatten(ss.raw,Œπs.map(Œπ=>[Œπ]))
	var show = Œπ=>{ var raw = [''] ;var Œπs = [] ;Œπ.forEach(Œπ=> Tstr(Œπ)? raw[-1]+=Œπ : (Œπs.push(Œπ) ,raw.push('')) ) ;return [{raw},...Œπs] }
	return f=> function(ss,...Œπs){return f.call(this,read(ss,Œπs),show) }
	})()

Œ≥.re = (Œπ,...Œπs)=>(
	is_template0(Œπ,Œπs)
		? simple_template(Œπ,Œπs,[(...a)=>re(...a).source,'']).map(Œπ=> !Tstr(Œπ)? êÖãêÖ®êÖ®êÖúêÖ¶(Œπ.raw) : Œπ).join('')
		: êÖãêÖ®êÖ®êÖúêÖ¶(Œπ)
	) [Œ≥["|>"]](Œπ=> RegExp(Œπ,'u'))
var êÖãêÖ®êÖ®êÖúêÖ¶ = Œπ=>0?0
	: T.RegExp(Œπ)? ( Œπ.flags.replace(/[gy]/g,'')==='u' || _interrobang_() ,Œπ.source )
	: Tarr(Œπ)? Œπ.map(êÖãêÖ®êÖ®êÖúêÖ¶).join('')
	: T.Set(Œπ)? `(?:${Œπ.map(êÖãêÖ®êÖ®êÖúêÖ¶).join('|')})`
	: (Œπ+'').replace(/([.*+?^${}()\[\]|\\])/g ,String.raw`\$1`)
String.prototype.re = function(...a){return this.match(re(...a)) }
RegExp.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"g")) .get=function(){return RegExp(this.source,this.flags.replace(/g/,'')+'g') }
RegExp.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"i")) .get=function(){return RegExp(this.source,this.flags.replace(/i/,'')+'i') }
RegExp.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"m")) .get=function(){return RegExp(this.source,this.flags.replace(/m/,'')+'m') }
RegExp.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"u")) .get=function(){return RegExp(this.source,this.flags.replace(/u/,'')+'u') }
RegExp.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"y")) .get=function(){return RegExp(this.source,this.flags.replace(/y/,'')+'y') }

Œ≥.js = Œ≥.py = (ss,...Œπs)=>{ var ENC = JSON.stringify ;return simple_template(ss,Œπs).map(Œπ=> !Tstr(Œπ)? ENC(Œπ.raw) : Œπ ).join('') }
Œ≥.Œ∂js = (ss,...Œπs)=>{ var ENC = JSON.stringify ;return simple_template(ss,Œπs).map(Œπ=> !Tstr(Œπ)? ENC(Œπ.raw) : Œ∂_compile(Œπ) ).join('') }
Œ≥.Œ∂ = (ss,...Œπs)=>{ var ENC = Œπ=> Œπ===undefined? '‚àÖ' : JSON.stringify(Œπ) ;return simple_template(ss,Œπs).map(Œπ=> !Tstr(Œπ)? ENC(Œπ.raw) : Œπ).join('') }

Œ≥.sh = (ss,...Œπs)=>{ var ENC = Œπ=> "'"+(Œπ+'').replace(/'/g,"'\\''")+"'" ;return simple_template(ss,Œπs,[sh,' ']).map(Œπ=> !Tstr(Œπ)? ENC(Œπ.raw) : Œπ).join('') }

var if_sh_err = (name,code,Œπ)=>{ if( Œπ.status ) throw Error(name+'`'+code+'` ‚Üí status:'+Œπ.status+' ,stderr:'+(Œπ.stderr+'').slice(0,100)) [Œ≥['‚Ä¶‚Üê']] (_u(Œπ).pick('status','stdout','stderr')) [Œ≥["!>"]](Œπ=> Œπ.stderr+='' ) }
Œ≥.sh·µ• = (ss,...Œπs)=>{ var code = sh(ss,...Œπs)
	// Œπ ‚Üê process_spawn('/bin/sh',{ ,args:['-c',code] ,‚öì:1 })
	var Œπ = node.child_process.spawnSync(code,{shell:true})
	if_sh_err('sh·µ•',code,Œπ)
	return Œπ.stdout [Œ≥['‚Ä¶‚Üê']] ({ toString(...a){ var Œπ = Buffer.prototype.toString.call(this,...a) ;return a["‚Äñ"]? Œπ : Œπ.replace(/\n$/,'') } }) }
Œ≥.sh·µ•exit = (ss,...Œπs)=>{ var r = catch_union(()=>sh·µ•(ss,...Œπs)); return T.Error(r)? r.status===0 : true }
var _sh‚Çê = (ss,Œπs,opt={})=>{
	if( ss["‚Äñ"]===2 && ss[0]==='' && ss[1].re`^ *\|$`){ opt.stdio && _interrobang_() ;opt.stdio = [œÜ.fd.from(Œπs[0]),'pipe','pipe',] ;return sh‚Çê2(opt) }
	else{ var code = sh(ss,...Œπs)
		// Œπ ‚Üê process_spawn('/bin/sh',{ ,args:['-c',code] } ‚Ä¶‚Üê (opt))
		// Œπ.exit.then(exit=>{ if_sh_err('sh‚Çê',code,Œπ ‚Ä¶‚Üê ({exit})) })
		var Œπ = node.child_process.spawn(code,{shell:true} [Œ≥['‚Ä¶‚Üê']] (_u(opt).pick('stdio','detached')))
			.on('exit',status=>{ if_sh_err('sh‚Çê',code,{status} [Œ≥['‚Ä¶‚Üê']] (Œπ)) })
		return Œπ } }
Œ≥.sh‚Çê = (ss,...Œπs)=> _sh‚Çê(ss,Œπs)
Œ≥.sh‚Çê2 = opt=>(ss,...Œπs)=> _sh‚Çê(ss,Œπs,opt)
Œ≥.sh‚Çêi = sh‚Çê2({stdio:process.stdio})
Œ≥.sh‚Çêlone = (...Œπ)=> sh‚Çê2({detached:true,stdio:'ignore'})(...Œπ) [Œ≥["!>"]]((êÖ≠êÖû)=>êÖ≠êÖû.unref())

process[Œ≥["|>"]] (Œπ=> new Property(Œπ,"stdio")) .get=function(){return [ this.stdin,this.stdout,this.stderr ] }
Œ≥._pisces__on_exits = f=> require('/usr/local/lib/êÖ™êÖ©modu/signal-exit@3.0.2__57/node_modules/signal-exit')((i,sig)=>{
	if( i===null ) i = 128+{ SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGSYS:12,SIGALRM:14,SIGTERM:15,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGUSR2:31 }[sig]
	f(i,sig) })
Œ≥._pisces__sub = Œπ=> _pisces__on_exits(()=>Œπ.kill()) // user ish?

Œ≥.osa = (ss,...Œπs)=>{var t;
	var Œπ = simple_template(ss,Œπs)
	// ! this is such a mess
	if( Tstr(Œπ[0]) && (t=Œπ[0].re`^(?!tell )([\w ]+):`)){ Œπ[0] = Œπ[0].slice(t[0]["‚Äñ"]) ;Œπ = [osa`tell app ${t[1]};` ,...Œπ ,' ;end tell'] }
	if( !Tstr(Œπ[0]) && Tstr(Œπ[0].raw) && Œπ[0].raw.re`^[\w ]+$` && Tstr(Œπ[1]) && (t=Œπ[1].re`^ *:`)){ Œπ[1] = Œπ[1].slice(t[0]["‚Äñ"]) ;Œπ = [osa`tell app ${Œπ.shift().raw};` ,...Œπ ,' ;end tell'] }
	return Œπ.map(Œπ=> !Tstr(Œπ)? applescript.print(Œπ.raw) : Œπ.replace(/;/g,'\n') ).join('') }
Œ≥.osa·µ• = (ss,...Œπs)=>{ var Œπ = osa(ss,...Œπs) ;return applescript.parse(sh·µ•`osascript -ss -e ${Œπ}`+'') }
Œ≥.osa‚Çê = (ss,...Œπs)=>{ var Œπ = osa(ss,...Œπs) ;sh‚Çê`osascript -ss -e ${Œπ}` }

// such hack
// YET ANOTHER Tag
var json2_read = Œπ=>{ var r = JSON.parse(Œπ) ;(function Œõ(Œπ,k,o){if( Œπ.type==='Buffer' ){
	var t = 'data' in Œπ || 'utf8' in Œπ? Buffer.from(Œπ.data||Œπ.utf8) : 'base64' in Œπ? Buffer.from(Œπ.base64,'base64') : _interrobang_()
	if( o===undefined ) r = t ;else o[k] = t
	} else if(! Tprim(Œπ) ) _u(Œπ).forEach(Œõ)})(r) ;return r }
var json2_show = Œπ=> JSON_pretty(Œπ,(À£,Œπ)=>{var t;
	if( T.Buffer(Œπ)) return _almost_equal_to_(Œπ,Buffer.from(t=Œπ+''))? { type:'Buffer' ,utf8:t} : { type:'Buffer' ,base64:Œπ.toString('base64') }
	return Œπ})
Œ≥[Œ≥["|>"]] (Œπ=> new Property(Œπ,"œÜ")) .thunk=()=>{
	// https://www.npmjs.com/package/glob-to-regexp
	var fs = node.fs
	var ENC = Œπ=> Œπ.re`/`? Œπ.replace(/[\/%]/g ,encodeURIComponent.X) : Œπ
	œÜ["‚Åª¬π"] = Œπ=> /%2F/i.test(Œπ)? Œπ.replace(/%2[F5]/gi ,decodeURIComponent.X) : Œπ
	œÜ.fd = {} ;œÜ.fd.from = Œπ=> fs.createReadStream(undefined,{ fd:fs.openSync(œÜ`/tmp/fd${_game_die_id.greek(20)}` [Œ≥['‚Ä¶‚Üê']] ({Œπ}) +'','r') })

	var existsSync = Œπ=> !T.Error(catch_union(()=> fs.accessSync(Œπ)))
	var mkdir_p = function Œõ(Œπ){ try{ fs.mkdirSync(Œπ) }catch(e){ if( e.code==='EEXIST'||e.code==='EISDIR') return ;var t = node.path.dirname(Œπ) ;if( e.code!=='ENOENT' || Œπ===t) throw e ;Œõ(t) ;fs.mkdirSync(Œπ) } }
	// walk ‚Üê Œª*(root,files){root += '/'
	// 	walk_ ‚Üê Œª*(Œπ){try {l ‚Üê fs.readdirSync(root+Œπ) ;for (i‚Üê0;i<l.‚Äñ;i++){t ‚Üê Œπ+l[i] ;try{ fs.statSync(root+t).isDirectory()? (yield root+t ,yield* walk_(t+'/')) : (files && (yield root+t)) }catch(e){} }} catch(e){} }
	// 	yield* walk_('') }
	var read_file = function(Œπ){ try{return fs.readFileSync(Œπ) }catch(e){ if( !(e.code==='ENOENT')) throw e } }
	var ensure_exists = function(Œπ,ifdne){ existsSync(Œπ) || ( mkdir_p(node.path.resolve(node.path.dirname(Œπ))) ,fs.writeFileSync(Œπ,ifdne) ) }
	var write_file = function(Œπ,data){ try{ fs.writeFileSync(Œπ,data) }catch(e){ if( !(e.code==='ENOENT')) throw e ;ensure_exists(Œπ,data) } }
	var open = function(Œπ,ifdne,f){
		ensure_exists(Œπ,ifdne) ;var Lc = new Œ¶(Œπ)["‚Äñ"]
		var fd = fs.openSync(Œπ,'r+') ;f({
			get L(){return Lc}
			,read(i,L){var t = Buffer.allocUnsafe(L) ;fs.readSync(fd,t,0,L,i) === L || _interrobang_() ;return t}
			,write(Œπ,i){var L = fs.writeSync(fd,Œπ,i) ;Lc = max(Lc ,L+i)}
			,truncate(L){fs.ftruncateSync(fd,L) ;Lc = min(Lc,L)}
			,indexOf_skipping(from,to,step,find,skip){var fl=this
				if( from<0) from += fl.L ;if( to<0) to += fl.L ;from = min(max(0 ,from ),fl.L-1) ;to = min(max(-1 ,to ),fl.L)
				if( !(step===-1 && from>to)) _interrobang_('TODO')
				var d = fl.read(to+1,from-to)
				for(var i=from;i>to;i+=step) {if( d[i-(to+1)]===find) return i ;else if( chr(d[i-(to+1)]).match(skip)) ;else return undefined}
				}
			}) ;fs.closeSync(fd)}
	var globmatch = (glob,Œπ)=> Œπ.re`^‚Ä¶${[...glob].map(Œπ=> Œπ==='*'? '.*' : re`${Œπ}`.source).join('')}$`
	œÜ[Œ≥["|>"]] (Œπ=> new Property(Œπ,"cwd")) .host= { get:()=> new Œ¶(process.cwd()) ,set:Œπ=> œÜ(Œπ+'')._Œπ [Œ≥["!>"]](mkdir_p) [Œ≥["!>"]](process.chdir) }
	var normHs = function(Œπ){ if( _almost_equal_to_( Œπ,['~'] ) ) return [process.env.HOME] ;Tstr(Œπ[0]) && (Œπ[0] = Œπ[0].replace(/^~(?=\/)/,process.env.HOME)) ;return Œπ }
	function Œ¶(Œπ){this._Œπ = Œπ} ;Œ¶.prototype = {
		œÜ
		,toString(){return this._Œπ }
		,toJSON(){return {type:'œÜ' ,Œπ:this._Œπ} }
		,inspect(À£,opts){return opts.stylize('œÜ','special')+opts.stylize(util_inspect_autodepth(this._Œπ.replace(re`^${process.env.HOME}(?=/|$)`,'~')).replace(/^'|'$/g,'`'),'string') }
		,get nlink(){return fs.statSync(this._Œπ).nlink }
		,get mtime(){return fs.statSync(this._Œπ).mtime }
		,get birthtime(){return fs.statSync(this._Œπ).birthtime }
		,get url(){return encodeURI('file:'+this.root('/')) } // ! should this be part of root
		,get is_dir(){return !!catch_Œπ(()=> fs.statSync(this._Œπ).isDirectory()) }
		,get name(){return node.path.basename(this._Œπ) }
		,TMP_children(){return this._Œπ [Œ≥["|>"]] (function Œõ(Œπ){return œÜ(Œπ).is_dir? fs.readdirSync(Œπ).map(t=> Œπ+'/'+t)['map‚Ä¶'](Œõ) : [Œπ] }) }
		,TMP_parents(){ var r = [this.root('/')] ;while(r[-1].œÜ`..`+'' !== r[-1]+'') r.push(r[-1].œÜ`..`) ;return r.slice(1) }
		,root(x){switch(arguments.length){default: 
			case 0: return this._Œπ[0]==='/'? '/' : '.'
			case 1: return new Œ¶( x==='/'? node.path.resolve(this._Œπ) : x==='.'? node.path.relative(x,this._Œπ) : _interrobang_('not yet implemented: nonstandard roots') )
			}}
		,ensure_dir(){ this.œÜ`..`["‚àÉ"] || mkdir_p(this.œÜ`..`+'') ;return this }
		,get dir_ensure(){ this["‚àÉ"] || mkdir_p(this+'') ;return this }

		// ,get Œπ(){‚Ü©}
		,set Œπ(Œπ){
			if( this.is_dir) _interrobang_('TODO')
			if( Œπ===undefined||Œπ===null){ catch_union(()=> fs.unlinkSync(this._Œπ) ) ;return }
			var e = node.path.extname(this._Œπ)
			if( e==='.csv'){ this.csv = Œπ ;return }
			if( e==='.xml'){ this.xml = Œπ ;return }
			if( e==='.plist'){ this.plist = Œπ ;return }
			Œπ = e==='.json'? JSON_pretty(Œπ) :
				Tstr(Œπ)? Œπ :
				Œπ instanceof Buffer? Œπ :
				JSON_pretty(Œπ)
			write_file(this._Œπ,Œπ) }
		,get buf(){return read_file(this._Œπ) || Buffer.alloc(0) }
		,set buf(Œπ){ write_file(this._Œπ,Œπ) }
		,get base64(){return Buffer.from(this.text,'base64') }
		// ,set base64(Œπ){}
		,get text(){return (read_file(this._Œπ) || '')+'' }
		,set text(Œπ){ write_file(this._Œπ,Œπ) }
		,get lines(){return function(...Œπs){
			var d = ((read_file(this._Œπ)||'\n')+'').replace(/\n$/,'').split('\n')
			if( Œπs["‚Äñ"] > 1) return Œπs.map(Œπ=> Tnum(Œπ)? d[Œπ] : d.slice(Œπ.re`^(\d+):$`[1]|0).join('\n')+'\n')
			else if( Œπs["‚Äñ"] === 0){
				return {
					map(...a){return d.map(...a)},
					} }
			else _interrobang_('TODO')
			}}
		,set lines(Œπ){ write_file(this._Œπ, Œπ.join('\n')+'\n') }
		,get json(){return JSON.parse(read_file(this._Œπ) || 'null') }
		,set json(Œπ){ write_file(this._Œπ, JSON_pretty(Œπ)) }
		,get json2(){return json2_read(this.text) }
		,set json2(Œπ){ this.text = json2_show(Œπ) }
		,get ini(){return require('/usr/local/lib/êÖ™êÖ©modu/ini@1.3.4__57/node_modules/ini').parse(this.text) }
		// ,set ini(Œπ){}
		// ,get csv(){‚Ü©}
		,set csv(Œπ){ var t = œÜ`/tmp/csv${_game_die_id.greek(25)}` ;t.json = Œπ ;sh·µ•`Œ∂ ${'npm`csv@0.4.6`.stringify('+js`œÜ(${t+''}).json,Œª(e,Œπ){ œÜ(${this.root('/')+''}).buf = Œπ })`}` }
		// ,get xml(){‚Ü© JSON.parse(sh·µ•`Œ∂ ${js`npm`xml2js@0.4.17`.parseString(œÜ(${@+''}).text,Œª(e,Œπ){ process.stdout.write(JSON.stringify(Œπ)) })`}`+'') }
		,set xml(Œπ){ this.text = require('/usr/local/lib/êÖ™êÖ©modu/xmlbuilder@8.2.2__57/node_modules/xmlbuilder').create(Œπ,{allowSurrogateChars:true}).end({pretty:true}) }
		,get plist(){var t; var buf = this.buf ;return 0?0
			// in case bplist-parser has bugs, this is available:
			// : which('plutil')? npm`plist@2.1.0`.parse(sh·µ•`plutil -convert xml1 -o - ${@.root('/')+''}`+'')
			: buf.slice(0,6)+''==='bplist'? ( t= œÜ`/tmp/plist${_game_die_id.greek(25)}`, sh·µ•`Œ∂ ${'npm`bplist-parser@0.1.1`.parseFile('+js`${this.root('/')+''},Œª(e,Œπ){ œÜ(${t+''}).plist = Œπ })`}`, t.plist )
			: require('/usr/local/lib/êÖ™êÖ©modu/plist@2.1.0__57/node_modules/plist').parse(this.text)
			}
		,set plist(Œπ){ this.text = require('/usr/local/lib/êÖ™êÖ©modu/plist@2.1.0__57/node_modules/plist').build(Œπ) }
		,get json_array__synchronized(){return function(...Œπs){var _Œπ=this._Œπ
			if( Œπs["‚Äñ"] ) _interrobang_('TODO')
			var d = JSON.parse((read_file(_Œπ)||'[]')+'')
			return {
			push(...a){a.map(function(Œπ){
				d.push(Œπ)
				open(_Œπ,'[]',function(fl){
					var i = fl.indexOf_skipping(-1,-1e4,-1,ord(']'),/[ \n\t]/) || _interrobang_('bad file')
					var is_0 = fl.indexOf_skipping(i-1,-1e4,-1,ord('['),/[ \n\t]/)!==undefined
					fl.write((is_0?'':',')+JSON.stringify(Œπ,undefined,'  ')+']',i)
					})
				})}
			,filter(f){return d.filter(f)}
			,get length(){return d["‚Äñ"]}
			,get ['‚Äñ'](){return d["‚Äñ"]}
			} }}
		,get size(){return fs.statSync(this._Œπ).size }
		,get ['‚Äñ'](){return fs.statSync(this._Œπ).size }
		}
	Œ¶.prototype[Œ≥["|>"]] (o=>( êÖãêÖ®êÖ¶êÖ®êÖ≠ = o ,êÖØêÖ≠êÖùêÖ®êÖÆ ))['‚àÉ'] [Œ≥['‚Ä¶‚Üê']]({ get(){return existsSync(this._Œπ) } ,set(Œπ){ Œπ===this["‚àÉ"] ||( this.Œπ = Œπ?'':undefined ) } })
	function Œ¶s(Œπ){this._Œπ = Œπ} ;Œ¶s.prototype = {
		inspect(À£,opts){return opts.stylize('œÜ','special')+node.util.inspect(this._Œπ,opts)}
		,get name_TMP(){return this._Œπ.map(Œπ=> new Œ¶(Œπ).name)} // fs.readdirSync
		,get œÜs(){return this._Œπ.map(Œπ=> new Œ¶(Œπ))} // [œÜ]
		}
	function œÜ(ss,...Œπs){
		var head = this instanceof Œ¶ && this._Œπ
		if( this instanceof Œ¶s ) _interrobang_('not yet implemented')
		var tmpl = is_template0(ss,Œπs)
		if( tmpl){var Œπ = simple_template(ss,Œπs,[œÜ,'/']) ;if( Œπ.filter(Tstr).join('').re`\*|\{[^}]*?,` ) {
			Œπ["‚Äñ"] <= 1 || _interrobang_('not yet implemented * ** ${}',Œπ)
			Œπ = normHs(Œπ)
			Œπ = Œπ[0]
			Œπ.includes('**') && _interrobang_('not yet implemented ** ${}',Œπ)
			var r = ['.']
			if( Œπ[0]==='/' ) r = ['/']
			Œπ.split('/').forEach(Œπ=>{
				if( Œπ==='' )return ;
				r = r['map‚Ä¶'](r=>{
					if( Œπ === '.' ) return [r]
					if( Œπ === '..' ) return [r==='.'? '..' : r.split('/').every(Œπ=>Œπ==='..')? r+'/..' : node.path.dirname(r)]
					return fs.readdirSync(r).filter(b=> globmatch(Œπ,b)).map(b=> r+'/'+b)
					})
				})
			return new Œ¶s(r) } }
		else {var Œπ = ss ;if( Œπs["‚Äñ"] || Tarr(Œπ)) _interrobang_('not yet implemented') ;if( Œπ instanceof Œ¶s ) _interrobang_('not yet implemented')}
		if( tmpl ){Œπ = normHs(Œπ).map(Œπ=> !Tstr(Œπ)? ENC(Œπ.raw+'') : Œπ).join('')}
		else if( Œπ instanceof Œ¶ ){return head && Œπ._Œπ[0]!=='/'? new Œ¶(head+'/'+Œπ._Œπ) : Œπ}
		else {Œπ = (Œπ+'').replace(/^~(?=\/|$)/,process.env.HOME)}
		return new Œ¶(node.path.normalize(head? head+'/'+Œπ : Œπ).replace(/(?!^)\/$/,'')) }
	return œÜ }

//############################# api interpretation ##############################
var comp2 = Œπ=> `'use strict';undefined;\n`+Œ∂_compile(Œπ)
var mem_sc = memoize_tick(Œπ=> new node.vm.Script(Œπ) )
var Œ∂_verify_syntax = Œπ=>{ Œπ = comp2(Œπ) ;try{ mem_sc(Œπ) }catch(e){ if( e instanceof SyntaxError ) return e } }
Œ≥.Œ∂_eval = Œπ=>{ Œπ = comp2(Œπ) ;return mem_sc.cache[Œπ]? mem_sc(Œπ).runInThisContext() : (0,eval)(Œπ) }

Œ≥.returnfix_compile = (()=>{return Œπ=>{var t; return bad(Œπ) && !bad(t='(=>{'+Œπ+'})()')? t : Œπ }
	function bad(Œπ){var t; return (t= Œ∂_verify_syntax(Œπ)) && t.message==='Illegal return statement' }
	})()
Œ≥.do_end_undefined_thing =(êÖ≠êÖû)=>êÖ≠êÖû.replace(/;\s*$/,';‚àÖ')

// i cut this out temporarily:
// e && Tstr(e.stack) &&( e.stack = e.stack.replace(/^([^]*)at repl:(.*)[^]*?$/,'$1at <repl:$2>') )
// e && Tstr(e.stack) &&( e.stack = e.stack.replace(/    at êÖ©êÖùêÖãêÖ¨êÖ™[^]*/,'    at <eval>') )

//##################################### see #####################################
;(Œ≥['‚Ä¶‚Üê'])(node.util.inspect.styles,{ null:'grey' ,quote:'bold' })
;[process,module].map((êÖ≠êÖû)=>êÖ≠êÖû.inspect = function(){return '{'+Object.getOwnPropertyNames(this).map(Œπ=> Œπ+':').join(', ')+'}' }) // ‚Ä° hack, like the [1] * 5 thing in Œ∂_repl_start. clean up by: can we override builtin inspects without problems? then: defining solid inspect functions for more things. otherwise: figure out something else.
;['Œ≥','Object'].map(Œπ=>{
Œ≥[Œπ].inspect = function(d,opt){return opt.stylize(Œπ,'quote') }
})
// Number_toFixed ‚Üê Œª(Œ∏,Œπ){ Œ∏ = round(Œ∏ / 10**-Œπ) * 10**-Œπ ;‚Ü© Œπ>0? Œ∏.toFixed(Œπ) : Œ∏+'' }
// Œ≥.pretty_time_num = Œπ=> new Number(Œπ) ‚Ä¶‚Üê ({inspect:Œª(À£,opt){ P ‚Üê 20 ;Œπ‚Üê@ ;[Œπ,u] ‚Üê (Œπ >= P/1e3? [Œπ,'s'] : [Œπ*1e6,'Œºs']) ;‚Ü© opt.stylize(Number_toFixed(Œπ,-max(-3,floor(log10(Œπ/P))))+u,'number') }})
// Œ≥.pretty_time_num = Œπ=> Unit(Œπ,'s')

var êÖãêÖÉ = function(a,b){ var t = this.__local? require('/usr/local/lib/êÖ™êÖ©modu/moment@2.18.1__57/node_modules/moment')(this).format('YYYY-MM-DD[T]HH:mm:ss.SSS') : this.toISOString() ;t = t.slice(a,b) ;if( !this.__local && b > 10) t += 'Z' ;return t }
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"local")) .get=function(){return new Date(this) [Œ≥['‚Ä¶‚Üê']] ({__local:true})}
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"y"))       .get=function(){return êÖãêÖÉ.call(this,0,'YYYY'["‚Äñ"])}
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"ym"))      .get=function(){return êÖãêÖÉ.call(this,0,'YYYY-MM'["‚Äñ"])}
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"ymd"))     .get=function(){return êÖãêÖÉ.call(this,0,'YYYY-MM-DD'["‚Äñ"])}
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"ymdh"))    .get=function(){return êÖãêÖÉ.call(this,0,'YYYY-MM-DDTHH'["‚Äñ"])}
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"ymdhm"))   .get=function(){return êÖãêÖÉ.call(this,0,'YYYY-MM-DDTHH:mm'["‚Äñ"])}
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"ymdhm"))   .get=function(){return êÖãêÖÉ.call(this,0,'YYYY-MM-DDTHH:mm'["‚Äñ"])}
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"ymdhms"))  .get=function(){return êÖãêÖÉ.call(this,0,'YYYY-MM-DDTHH:mm:ss'["‚Äñ"])}
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"ymdhmss")) .get=function(){return êÖãêÖÉ.call(this,0,'YYYY-MM-DDTHH:mm:ss.SSS'["‚Äñ"])}
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"mdhm"))    .get=function(){return êÖãêÖÉ.call(this,'YYYY'["‚Äñ"],'YYYY-MM-DDTHH:mm'["‚Äñ"])}
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"hms"))     .get=function(){return êÖãêÖÉ.call(this,'YYYY-MM-DDT'["‚Äñ"],'YYYY-MM-DDTHH:mm:ss'["‚Äñ"])}
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"day")) .get=function(){return this.i/86400 }
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"day_s")) .get=function(){return (this.day+'').replace(/^(.*\..{4}).*/,'$1') }
Date.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"day_s3")) .get=function(){return (this.day+'').replace(/^(.*\..{3}).*/,'$1') }

Œ≥.Unit = (Œπ,u)=>0?0: {Œπ,u}
	[Œ≥["!>"]]((êÖ≠êÖû)=>êÖ≠êÖû[Œ≥["|>"]] (Œπ=> new Property(Œπ,"valueOf")) [Œ≥["!>"]]((êÖ≠êÖû)=>êÖ≠êÖû.enumerable= false) .Œπ=function(){return this.Œπ } )
	[Œ≥["!>"]]((êÖ≠êÖû)=>êÖ≠êÖû[Œ≥["|>"]] (Œπ=> new Property(Œπ,"inspect")) [Œ≥["!>"]]((êÖ≠êÖû)=>êÖ≠êÖû.enumerable= false) .Œπ=function(À£,opt){return node.util.inspect(this.Œπ,opt)+' '+opt.stylize(this.u,'number') } )
Number.prototype.inspect = function(d,opt){'use strict' ;var Œπ = this ;if(! Tprim(Œπ) ) return Œπ ;return Œ∂_inspect(Œπ,opt) }
Boolean.prototype.inspect = function(d,opt){'use strict' ;var Œπ = this ;if(! Tprim(Œπ) ) return Œπ ;return Œ∂_inspect(Œπ,opt) }
Date.prototype.inspect = function(d,opt){return opt.stylize(isNaN(+this)? 'Invalid Date' : this.getUTCSeconds()!==0? this.ymdhms : this.getUTCMinutes()!==0? this.ymdhm : this.getUTCHours()!==0? this.ymdh : this.ymd, 'date')}
// ,'Function.prototype.inspect':Œª(rec,ctx){t ‚Üê Œ∂_compile.‚Åª¬π(@+'').replace(/^Œª \(/,'Œª(').match(/^.*?\)/) ;‚Ü© ctx.stylize('['+(t?t[0]:'Œª ?(?)')+']', 'special')}
// ,'Buffer.prototype.inspect':Œª Œõ(){‚Ü© Œõ.super.call(@).replace(/(^<\w+)/,'$1['+@.‚Äñ+']')}
// ,inspect(À£,opt){‚Ü© opt.stylize('œÜ','special')+opt.stylize(node.util.inspect(@._Œπ.replace(re`^${process.env.HOME}(?=/|$)`,'~')).replace(/^'|'$/g,'`'),'string') }
Array.prototype[Œ≥["|>"]] (Œπ=> new Property(Œπ,"line")) .get=function(){ this.toString = this.inspect = function(){return this.join('\n') } ;return this }
Œ≥.util_inspect_autodepth = (Œπ,opt={})=>{ opt.L || (opt.L = 1e7) ;var last; for(var i=1;;i++){ var r = node.util.inspect(Œπ,{ maxArrayLength:opt.L/3 |0 ,depth:i } [Œ≥['‚Ä¶‚Üê']] (opt)) ;if( r===last || r["‚Äñ"] > opt.L) return last===undefined? '<too large>' : last ;last = r } }
var êÖØêÖ¶ = (Œπ,opt={})=> util_inspect_autodepth(Œπ,_u(opt).pick('colors','L'))
var promise_watch = Œπ=>{ if(! Œπ.id ){
	Œπ.id = (êÖ©êÖûêÖãêÖ¶êÖ©++).toString(36)
	var hr = hrtime() ;Œπ.then(x=>{ var x = Œ∂_inspect(x) ;hrtime(hr) < 5 && x["‚Äñ"] && hs·µ•`hs.alert(${`Promise #${Œπ.id} = ${x.slice(0,200)}`},12)` }) } ;return Œπ.id } ;var êÖ©êÖûêÖãêÖ¶êÖ©=0
var stylize = ({colors})=>{ node.util.inspect({inspect(d,opt){ r = opt.stylize }},{colors}) ;var r ;return r }
Œ≥.Œ∂_inspect = (Œπ,opt={})=>0?0
	: Œπ===undefined? ''
	: T.truefalse(Œπ)? stylize(opt)(Œπ?'‚úì':'‚úó' ,'boolean')
	: Tstr(Œπ)? Œπ
	: Tnum(Œπ)? stylize(opt)(0?0
		: Object.is(Œπ,-0)? '-0' : Œπ===Infinity? '‚àû' : Œπ===-Infinity? '-‚àû'
		: Number.isSafeInteger(Œπ)? ''+Œπ
		: Œπ.toExponential().replace('+','').replace(/(\.\d\d)\d+/,'$1').replace('e0','')
		,'number')
	: T.Promise(Œπ)? 0?0
		: Œπ.status? 'Œ† '+êÖØêÖ¶(Œπ.Œπ,opt)
		: Œπ.status===undefined? `Œ† #${promise_watch(Œπ)} #pending`
		: êÖØêÖ¶(Œπ,opt)
	: Tarr(Œπ) && Œπ["‚Äñ"] > 1 && Œπ.every(t=> t===Œπ[0]) && _midline_horizontal_ellipsis_(Œπ["‚Äñ"]).every(t=> t in Œπ)
		? êÖØêÖ¶([Œπ[0]],opt)+' √ó '+êÖØêÖ¶(Œπ["‚Äñ"],opt)
	: êÖØêÖ¶(Œπ,opt)
// node.EventEmitter.prototype.inspect
var sh_inspect = Œπ=>{var t;
	var Œ† = Œπ=> Promise.resolve(Œπ) // COPY
	return Œ†( 0?0
	: T.Promise(Œπ)? Œπ.then(sh_inspect)
	: Œπ===undefined? {}
	: Tstr(Œπ)? {out:Œπ}
	: T.truefalse(Œπ)? {code:Œπ?0:1}
	: ( t= catch_union(()=> JSON.stringify(Œπ)) ,!T.Error(t) )? {out:t}
	: {out:Œπ+''} )}

var is_browser = ( Œ≥.process&&process.type==='renderer' ) || !( Œ≥.process&&process.versions&&process.versions.node )
Œ≥.single_if = Œπ=> Œπ["‚Äñ"]===1? Œπ[0] : Œπ
Œ≥.log = (...Œπ)=>( log.Œπ(Œπ) ,Œπ[-1] )
log.Œπ = is_browser? Œπ=> console.log(...Œπ)
	: single_if [Œ≥["‚â´"]] (Œπ=> process.stdout.write(Œ∂_inspect(Œπ,{ colors:process.stdout.isTTY })+'\n'))
Œ≥.log2 = (...Œπ)=> log( Time().day_s [Œ≥["|>"]](t=>0?0:{inspect:()=>t}) ,...Œπ ) // log2rue

Œ≥.JSON_pretty = (Œπ,replacer)=>{
	var seen = []
	var tab = '  '
	var wrap_width = 140
	var indent_show = Œπ=> show(Œπ).replace(/\n/g,'\n'+tab)
	var show = Œπ=>{var t;
		if( Œπ===undefined||Œπ===null ) return 'null'
		replacer && (Œπ = replacer(undefined,Œπ))
		while( Œπ.toJSON ) Œπ = Œπ.toJSON()
		switch( typeof(Œπ)==='object'? Object.prototype.toString.call(Œπ) : typeof(Œπ) ){
			case 'string': case '[object String]': return JSON.stringify(Œπ)
			case 'boolean': case '[object Boolean]': case 'number': case '[object Number]': return Œπ+''
			case 'function': return 'null'
			default:
				!seen.includes(Œπ) || _interrobang_(TypeError('Converting circular structure to JSON'))
				seen.push(Œπ)
				if( Tarr(Œπ)) { var [a,b] = '[]' ;Œπ = Œπ.map(indent_show) ;for (var i=0;i<Œπ["‚Äñ"];i++) Œπ[i]===undefined && (Œπ[i] = 'null') }
				else { var [a,b] = '{}' ;Œπ = _l.toPairs(Œπ).filter(Œπ=> !(Œπ[1]===undefined || Tfun(Œπ[1]))).map(Œπ=> show(Œπ[0])+': '+indent_show(Œπ[1])) }
				seen.pop()
				return (t=a+Œπ.join(', ')+b)["‚Äñ"] <= wrap_width? t : a+'\n'+tab+Œπ.join(',\n'+tab)+'\n'+b
				} }
	return show(Œπ) }

process.on('unhandledRejection',(e,p)=> log(Time(),'process.unhandledRejection',p) )

//################ repl #################
var Œ∂_repl_start = ()=>{
	// i know how to make the good repl for ct. i want to, but im tired
	var diesis_compile = Œπ=>{var t;
		// of course this is lovely but it is a dead end - we want Sight
		var lock = 0?0
			: ['ct','chrome_tabs','ps2','d','bookmarks']["‚à™"]([]).has(Œπ)? Œπ+'()'
			: (t= Œπ.re`^f(?: (.+))?$` )? js`go_to('path',${t[1]||'.'})`
			: Œπ
		lock===Œπ || log('‚õì  '+lock)
		return lock }
	// @2018-01-04 current priority is to work on seeing first; merging w Œ∂_repl_start
	// '\x1b[30m\x1b[42mŒ∂\x1b[0m '
	return (f=> f.call( node.repl.start({ useGlobal:true ,prompt:'\x1b[30m\x1b[100m‚Ä°\x1b[0m ' }) ))(function(){
	this.In = [] ;this.Out = []
	var super_ = this.completer ;this.completer = function(line,cb){ line.trim()===''? cb(undefined,[]) : super_.call(this,line,cb) }
	this.removeAllListeners('line').on('line',function(line){
		this.context.rl = this
		this.context.E = this.context // ! what?
		if( this.bufferedCommand ){ var Œπ = this.history ;Œπ.reverse() ;var t = Œπ.pop() ;Œπ[-1] += '\n'+t ;Œπ.reverse() }
		var code = this.bufferedCommand+line
		code = diesis_compile(code)
		if( Œ∂_verify_syntax(code) ){ this.bufferedCommand = code+'\n' ;this.outputStream.write('    ') ;return }
		try{ var Œπ = (0,eval)(Œ∂_compile(code)) }catch(e){ var error = e }
		this.bufferedCommand = ''
		if( code ){
			œÜ`~/.archive_Œ∂`.text = œÜ`~/.archive_Œ∂`.text + JSON.stringify({ time:Time() ,code }) + '\n'
			this.In.push(code) ;this.Out.push(error || Œπ)
			}
		if( error ) this._domain.emit('error' ,error.err || error)
		else{
			if( T.Promise(Œπ) ) this.context[Œ≥["|>"]] (Œπ=> new Property(Œπ,"__")) .f1Œπ= Œπ
			else if( Œπ!==undefined ) this.context.__ = Œπ
			try{ var t = Œ∂_inspect(Œπ,{ colors:this.outputStream.isTTY }) }catch(e){ var t = '<repl inspect failed>:\n'+(e&&e.stack) }
			this.outputStream.write(t && t+'\n') }
		this.displayPrompt()
		})
	this.removeAllListeners('SIGINT').on('SIGINT',function(){
		var is_line = this.bufferedCommand+this.line
		this.clearLine()
		if( is_line ){ this.bufferedCommand = '' ;this.displayPrompt() } else this.close()
		})
	delete this.context._ ;this.context._ = _u
	return this }) }

//################################## new tools ##################################
Œ≥.simple_as_file = Œπ=> œÜ`/tmp/asf_${simple_hash(Œπ)}` [Œ≥['‚Ä¶‚Üê']]({Œπ}) +''

//#################################### user #####################################
process.env.PATH = ['./node_modules/.bin','/usr/local/bin',...(process.env.PATH||'').split(':'),'.']["‚à™"]([]).join(':')

Œ≥._musical_note_ = Œπ=> sh‚Çêlone`afplay ${Œπ}`
Œ≥._musical_note_d = Œπ=> net1._0_œÜ_seenbydevice0(`https://www.dropbox.com/s/${Œπ}?dl=1`).then(Œπ=>_musical_note_(Œπ.o))
Œ≥[Œ≥["|>"]] (Œπ=> new Property(Œπ,"nacksoft")) .get=()=> _musical_note_d`kaphh65p0obaq93/nacksoft.wav`

//################################### prelude ###################################
require(œÜ`~/code/scratch/Œ∂/module.Œ∂`+'').put_Œ≥()

//################################# deprecated ##################################
var êÖ≠êÖÇêÖ≠êÖ™ = (names,within,f)=>{
	var dir = œÜ`~/file/.cache/memo_frp/${names}`
	if( within ){
		try{ var t = node.fs.readdirSync(dir+'') }catch(e){ e.code==='ENOENT' || _interrobang_(e) ;var t = [] }
		var now = Time().i ;t = t.sort().filter(Œπ=> Time(Œπ.re`^\S+`[0]).i >= now - within )[-1]
		if( t ) return dir.œÜ(t).json2.Œπ }
	var a = Time().ymdhmss ;var Œπ = f() ;var b = Time().ymdhmss
	dir.œÜ`${a} ${_game_die_id(10)}`.json2 = { names ,date:[a,b] ,Œπ } ;return Œπ }
Œ≥.GET_L = (Œπ,within)=> êÖ≠êÖÇêÖ≠êÖ™(['GET -L' ,Œπ+''] ,within ,()=> sh·µ•`curl -sL ${Œπ}`)
// ! some requests have short responses ;will need more intelligent caching for those 'cause the filesystem can't take too much
// ! curl error code 6 means can't resolve & is crashing things maybe

//#################################### main #####################################
Œ≥ [Œ≥['‚Ä¶‚Üê|']] ({ require ,module:{ exports:{} ,if_main_do:module.__proto__.if_main_do } ,i:0 })
Œ≥.Œ∂_main = ({a})=>{var Œπ;
	a[0]==='--fresh' && a.shift()
	if( !a["‚Äñ"] ) Œ∂_repl_start()
	else if( Œπ=a[0] ,œÜ(Œπ)["‚àÉ"] || Œπ.re`^\.?/` ){ process.argv = [process.argv[0],...a] ;var t = œÜ(Œπ).root('/')+'' ;var o=node.Module._cache;var m=node.Module._resolveFilename(t,undefined,true);var oŒπ=o[m] ;o[m] = undefined ;node.Module._load(t,undefined,true) ;o[m] = oŒπ }
	else {
		Œ≥.a = a ;var code = a.shift() ;[Œ≥.a0,Œ≥.a1] = a ;Œ≥.Œπ = a[0]
		sh_inspect( Œ∂_eval(returnfix_compile(do_end_undefined_thing(code))) )
			.then(Œπ=>{ Œπ.out && process.stdout.write(Œπ.out) ;Œπ.code &&( process.exitCode = Œπ.code ) })
		}
	}
module.if_main_do((...a)=>Œ∂_main({a}))
